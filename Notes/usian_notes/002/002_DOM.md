# 2.7 DOM 

### 7.1文档对象模型

**DOM**(document object model)  作用  
	通过可编程的对象模型，JavaScript 获得了足够的能力来创建动态的 HTML。
	JavaScript 能够改变页面中的所有 HTML 元素
	JavaScript 能够改变页面中的所有 HTML 属性
	JavaScript 能够改变页面中的所有 CSS 样式
	JavaScript 能够对页面中的所有事件做出反应
	
	静态：没有
	动态：有数据交互（ajax）
	
	JavaScript是让静态HTML文档“动起来”的脚本程序语言。
	
	“动起来”有两层意思：
		其一，让页面中的标签元素能够实现动态、动画
		其二，能够响应用户的操作、响应事件

###  7.2DOM树形结构

```
document (HTMLDocument)  
|  
| --> html (HTMLHtmlElement)          
	|       
	| --> head (HtmlHeadElement)          
	|       	|          
	|       	| --> title (HtmlTitleElement)          
	|                | --> text: "A super simple title!"          
	|          
	| --> body (HtmlBodyElement)          
	|       |          
	|       | --> h1 (HTMLHeadingElement)          
	|              | --> text: "A super simple web page!"
```




### 7.3节点类型(了解)

节点类型:文档中的内容，包括标签、文本、注释、标签属性等
		文档节点：整个文档
		元素节点：每个 HTML 标签
		文本节点：包含在 HTML 元素中的文本
		属性节点：每一个 HTML 属性
		注释节点：注释

```
var boxs=document.querySelector("body").childNodes;
for(var i<0;i<boxs.length;i++){
	console.log(boxs[i].nodeType)
}

nodeType 属性返回节点的类型。nodeType 是只读的。
比较重要的节点类型有：
元素类型	NodeType
元素		1
属性		2
文本		3
注释		8
文档		9
```

| 方法      |                   说明                   |
| :-------- | :--------------------------------------: |
| nodeName  |  返回一个字符串，其内容是给定节点的名字  |
| nodeType  | 返回一个整数，这个数值代表给定节点的类型 |
| nodeValue |           返回给定节点的当前值           |

### 7.4节点关系

​		父子关系 
​		兄弟关系 
​		祖孙关系 
​	节点树中的节点彼此拥有层级关系。
​		父（parent）、子（child）和同胞（sibling）等术语用于描述这些关系。
​		父节点拥有子节点。同级的子节点被称为同胞（兄弟或姐妹）。
​		在节点树中，顶端节点被称为根（root）
​		每个节点都有父节点、除了根（它没有父节点）
​		一个节点可拥有任意数量的子
​		同胞是拥有相同父节点的节点

| 方法            |                        说明                        |
| :-------------- | :------------------------------------------------: |
| childNodes      | 返回一个数组，这个数组有给定的元素节点的子节点构成 |
| firstChild      |                  返回第一个子节点                  |
| lastChild       |                 返回最后一个子节点                 |
| parentNode      |              返回一个给定节点的父节点              |
| nextSibling     |           返回一个给定节点的下一个子节点           |
| previousSibling |           返回一个给定节点的上一个子节点           |

### 7.5文档写入

```js
document.write("<h1>sss</h1>");
document.writeln("<h1>8888</h1>");
```

### 7.6.1查找元素6种方法

document.getElementById();返回对拥有指定 id 的第一个对象的引用。

document.querySelector();返回文档中匹配指定的CSS选择器的**第一元素**

document.querySelectorAll();HTML5中引入的新方法，返回文档中匹配的CSS选择器的**所有元素节点列表**

document.getElementsByTagName();返回带有指定标签名的对象集合。

document.getElementsByClassName();返回文档中所有指定类名的元素集合，作为 NodeList 对象。

document.getElementsByName();返回带有指定名称的对象集合。	

```js
// id
var one= document.getElementById("a"); // 对象
console.log(one );
// console.log( typeof one ,one instanceof Object);

//class
var two= document.getElementsByClassName("b"); // 伪数组
console.log(two);
// console.log( Object.prototype.toString.call(two) );

//标签
var three= document.getElementsByTagName("div");// 伪数组
console.log(three);
// name
var four= document.getElementsByName("c");// 伪数组
console.log( four );

// 根据选择器 获取一个 

var five=document.querySelector("div"); // 只能获得 第一个
console.log(five);

// 根据选择器 获取所有 [] 伪数组
var six= document.querySelectorAll("#a"); // 获取所有匹配的元素 []伪数组
console.log(six)
```

​		

### 7.7操作元素内容5种方法

innerHTML:设置或获取位于对象起始和结束标签内的 HTML 
innerText:设置或获取位于对象起始和结束标签内的文本 
outerHTML:设置或获取对象及其内容的HTML形式 
outerText:设置(包括标签)或获取(不包括标签)对象的文本 
value:input,select,textarea,checkbox,radio内容的获取和设置

```js
var oneDom=document.getElementById("one");//对象
            // oneDom.innerHTML ="456";   
            // oneDom.innerHTML="<h1>5555</h1>";

            // oneDom.innerText="5555";
            // oneDom.innerText="<h1>5555</h1>";


            // oneDom.outerHTML="8888";
            // oneDom.outerHTML="<h1>8888</h1>";

            // oneDom.outerText="888"
           // oneDom.outerText="<h1>888</h1>"


var inputDom= document.getElementById("two")
console.log( inputDom.value ); // .value 获取 或设置 表单的值
inputDom.value=123;
```

查找元素的区别

```js
         var oneDom=document.getElementById("one");
            oneDom.innerText="哈哈哈哈哈";
//------
        var boxDom=document.getElementsByTagName("div");
        console.log(boxDom);
        boxDom[0].innerText="哈哈哈";
//------
        var liDom=document.getElementsByClassName("two");
            // console.log(liDom)
            // liDom[0].innerText="0"
            // liDom[1].innerText="1"
            // liDom[2].innerText="2"
            // liDom[3].innerText="3"

            for(var i=0;i<liDom.length;i++){
                liDom[i].innerText=i;
            }
```

### 7.8操作元素的行内样式

obj.style.property="新样式";

​		property指color;font-size;background等

```js
//<div id="one" >888</div>

var oneDom=document.getElementById("one");

oneDom.style.width="100px";
oneDom.style.height="100px";
oneDom.style.border="1px solid red";
oneDom.style.marginLeft="100px";
```

### 7.9操作元素属性俩种方法

obj.attr="新属性值";attr指属性名,如src;id;name,value,type,href,rel,type,alt,width,heigth等
obj.属性名 = "新属性值";
		
obj.hasAttribute()	如果元素中存在指定的属性返回 true，否则返回false。

obj.setAttribute();//设置属性	(属性名， 属性值1   属性值2)
obj.getAttribute();//获取属性
obj.removeAttribute();//删除属性

```js
var imgDom=document.getElementById("one");
// 1、元素对象.属性名
            // console.log( imgDom.alt)
            // imgDom.alt="888888"

// 2、 获取：元素对象.getAttribute("属性名") 
//     设置：元素对象.setAttribute("属性名","值")
//     移除：元素对象.removeAttribute("属性名") 
//  是否存在：元素对象.hasAttribute("属性名") 

console.log( imgDom.getAttribute("title") );
imgDom.setAttribute("title","8888888888");
imgDom.removeAttribute("class");
console.log( imgDom.hasAttribute("class") );
```



### 7.10  class 属性操作

```js
//<div id="one" class="">222</div>

var boxDom= document.getElementById("one");
// 获取class 属性 元素对象.classList
// 添加class 属性 元素对象.classList.add(类名1,类名2)
// 移除class 属性 元素对象.classList.remove(类名1,类名2)
boxDom.classList.add("box","boxText");
//boxDom.classList.remove("box","boxText");
```



### 7.11  js将伪数组变成真数组的三种方法

 

js将伪数组变成真数组的三种方法

1、 [].slice.call(obj) 这个等于Array.prototype.slice.call(obj)

```js
var newArr=[].slice.call(obj)
```

2. Array.form(obj),ES6的新语法

   ```js
   var newArr=Array.from(obj)
   ```

3. 使用扩展运算符,也是ES6的语法

   ```js
   var newArr= [...obj]
   ```

   

### 7.12获取元素标签名

比如通过id获取的一个元素节点, 想知道这个节点是什么什么标签, 这时可以通过: **Node.prototype.nodeName**属性 或 **Element.prototype.tagName**属性获取.

```js
// HTML 
// <div id="app">Hello</div>

document.getElementById("app").tagName;
// "DIV"

document.querySelector("#app").nodeName;
// "DIV"
```

**注意:** tagName和nodeName返回的结果是完全一样的, 只是tagName在Element接口上, nodeName在Node接口上

### 7.13  点赞案例

```html
<button onclick="zan()" id="btn">👍0</button>

<script>
var i=0;

function zan(){
      console.log("点了");
     var btnDom=document.getElementById("btn");
     // document.querySelector("#btn")
    // console.log(btnDom);
    i++;
    btnDom.innerText="👍"+ i;
    }
 </script>
```

### 7.14  !!!!案例   隔行变色

```html
   <button onclick="opens()">开启隔行变色</button>
    <button onclick="closes()">关闭隔行变色</button>

    <table border="1">
        <thead>
            <tr>
                <th>姓名</th>
                <th>年龄</th>
            </tr>
        </thead>
        <tbody id="tbody">
            <tr>
                <td>gg</td>
                <td>18</td>
            </tr>

            <tr >
                <td>gg2</td>
                <td>18</td>
            </tr>

            <tr>
                <td>gg3</td>
                <td>18</td>
            </tr>
            <tr >
                <td>gg4</td>
                <td>18</td>
            </tr>
            <tr>
                <td>gg5</td>
                <td>18</td>
            </tr>
            <tr >
                <td>gg6</td>
                <td>18</td>
            </tr>
        </tbody>
    </table>

    <script>
         var trsDom=document.querySelectorAll("#tbody > tr");
         var trsArr=Array.from(trsDom);

        function opens(){
            console.log("点击了 开启 按钮");
            //var trsDom=document.querySelectorAll("#tbody > tr");
            //var trsArr=Array.from(trsDom);
            // console.log(trsDom);
            // console.log(trsArr);
            for(var i =0;i<trsArr.length;i++){
                if(i%2!==0){
                    // console.log(i);
                    trsArr[i].classList.add("trs");
                }
            }

        }

        function closes(){
            console.log("点击了 关闭 按钮");
            //var trsDom=document.querySelectorAll("#tbody > tr");
            //var trsArr=Array.from(trsDom);
            // console.log(trsDom);
            // console.log(trsArr);
            for(var i =0;i<trsArr.length;i++){
                if(i%2!==0){
                    // console.log(i);
                    trsArr[i].classList.remove("trs");
                }
            }
        }
    </script>
```

### 7.15  事件绑定的三种 方法

```js
<button onclick="btn1()" onclick="btnx()">点击1</button>
    <button id="btn2">点击2</button>
    <button id="btn3">点击3</button>

    <script>
//1----------------------        
        function btn1(){
            console.log("点击了按钮1");
            console.log(this);// 
        }

        // function btnx(){
        //     console.log("点击了按钮1-x");
        // }
//2--------------------------
        var btn2Dom=document.getElementById("btn2");
            btn2Dom.onclick=function(){
                console.log("点击了按钮2");
                console.log(this);// 
            }

            // btn2Dom.onclick=function(){
            //     console.log("点击了按钮2-x");
            // }

//3------------------------------
        var btn3Dom=document.getElementById("btn3");
            // 添加事件监听
            btn3Dom.addEventListener("click",function(){
                console.log("点击了按钮3")
                console.log(this);// 
            }) 

            // btn3Dom.addEventListener("click",function(){
            //     console.log("点击了按钮3-x")
            // }) 


            /*
                区别：
            一、
                1、相同事件类型 ，只执行 第一个
                2、相同事件类型 ，执行最后一个
                3、相同事件类型 ，都执行

            二、 1、this -- window
                2、this -- 当前发生事件的 dom 对象
                3、this -- 当前发生事件的 dom 对象


            */
```

### 7.16  this

```js
// this --函数中才有- -->对象
// 普通函数 this 指向 调用时的对象 （会变）-- . 前面是谁 就是谁 ｜  没有. === window
// 箭头函数 this 指向 声明时的对象  （不变）


        function a(){
            console.log(this);//
        }

        a();

        // window.a();

        var obj={
            "name":"aaaa",
            "say":function(){
                console.log("hhhhh");
                console.log(this);//
            }
        }
        obj.say();
        
        var x= obj.say;
        x();
```

7.17

# 2.8 

### 8.1节点属性

1.childNodes  返回包含被选节点的子节点的 NodeList

​		如果选定的节点没有子节点，则该属性返回不包含节点的 NodeList。

​		如需循环子节点列表，使用 nextSibling 属性，要比使用父对象的 childNodes 列表效率更高。

2.firstChild 	返回被选节点的第一个子节点,如果选定的节点没有子节点，则该属性返回 NULL。 

​			获取指定元素的第一个子节点，可以是元素节点，也可以是文本节点。

3.lastChild 	可返回文档的最后一个子节点。

4.ownerDocument 可返回某元素的根元素。

5.parentNode 	可返回某节点的父节点。如果指定的节点没有父节点则返回 null。

6.previousSibling 可返回某节点之前紧跟的节点（处于同一树层级）

​		返回节点以节点对象返回。注意：如果没有此节点，那么该属性返回 null。

7.nextSibling 	 可返回某个元素之后紧跟的节点（处于同一树层级中）。

​		返回节点以节点对象返回。注意： 如果元素紧跟后面没有节点则返回 null.

```html
<ul id="ul">
        <li>11</li>
        <li>22</li>
        <li id="a">33</li>
        <li>44</li>
    </ul>
```

```js
var ulDom=document.getElementById("ul");
     console.log("ul的所有子节点-元素+文本",ulDom.childNodes);
     console.log("ul的所有子元素节点", ulDom.children)
     console.log("ul下第一个子节点",ulDom.firstChild);
     console.log("ul下第一个子元素节点",ulDom.firstElementChild)
     console.log("ul下最后一个子节点",ulDom.lastChild);
     console.log("ul下最后一个子元素节点",ulDom.lastElementChild)
     console.log("-----------------------")
     var aLiDom= document.getElementById("a");
     console.log("上一个兄弟节点",aLiDom.previousSibling);
     console.log("上一个兄弟元素 节点",aLiDom.previousElementSibling)
     console.log("下一个兄弟节点",aLiDom.nextSibling);
     console.log("下一个兄弟元素 节点",aLiDom.nextElementSibling)
     console.log("父节点",aLiDom.parentNode );
     console.log("父节点",aLiDom.parentElement );
```



### 8.2元素属性

1.children  属性返回元素的子元素的集合，是一个 HTMLCollection 对象。只返回元素节点

2.parentElement 	可返回某节点的父节点。如果指定的节点没有父节点则返回 null 。

3.firstElementChild 返回被选节点的第一个子元素节点,如果选定的节点没有子元素节点，则该属性返回 NULL。获取指定元素的第一个子元素节点，不会检测到文本节点。

4.lastElementChild  返回被选节点的最后一个子元素节点,如果选定的节点没有子元素节点，则该属性返回 NULL。

5.previousElementNode 可返回某节点之后紧跟的元素节点（处于同一树层级）注意：如果没有此元素节点，那么该属性返回 null。

6.nextElementNode  可返回某节点之前紧跟的元素节点（处于同一树层级）注意：如果没有此元素节点，那么该属性返回 null。



### 8.3节点操作方法 

| 方法                           |                          说明                          |
| :----------------------------- | :----------------------------------------------------: |
| createElement(element)         |                    创建一个新的节点                    |
| createTextNode()               |           创建一个包含着给定文本的新文本节点           |
| appendChild()                  |   指定节点的最后一个子节点列表之后添加一个新的子节点   |
| 父节点.append() 可以传入多个   |                                                        |
| insertBefore()                 | 将一个给定节点插入到一个给定元素节点的给定子节点的前面 |
| removeChild(要删除的元素)      |             从一个给定元素中删除一个子节点             |
| replaceChild(新节点，老节点)   |    把一个给定父元素里的一个子节点替换为另外一个节点    |
| 自身节点.remove() 将本身移除掉 |                                                        |



#### 8.3.1创建

​	document.createElement()通过指定名称创建一个元素
​	document.createTextNode()可创建文本节点。

```js
var h1Dom= document.createElement("h1");
        console.log("创建元素节点",h1Dom);

var textDom=document.createTextNode("h1");
        console.log("创建文本节点",textDom);
```



#### 8.3.2添加

​	父节点.appendChild() 节点的子节点列表的末尾添加新的子节点。

   父节点.append() 可以传入多个

​	父节点.insertBefore(插入的新节点，原节点)   在已有的子节点前插入一个新的子节点

```html
<div id="box">
    <h1>123</h1>
</div>
```

```js
// 创建 h2 元素标签 对象
var h2Dom=document.createElement("h2");
    h2Dom.innerText=456;

// 创建 h3 元素标签 对象 
var h3Dom=document.createElement("h3");
    h3Dom.innerText=789;

// 获取div -父元素
var boxDom=document.getElementById("box");

// 父元素.appendChild(子元素) 在父元素内部 末尾 追加一个节点
boxDom.appendChild(h2Dom);
boxDom.appendChild(h3Dom);

// 在父元素内部 末尾 追加多个节点
// boxDom.append(h2Dom,h3Dom)
```

```js
// 在父元素 内部 某个元素 之前添加
// 父元素.insertBefore(新元素，目标元素)

// 在 div 内部 h1 之前 添加 <p>哈哈哈哈</p>
// 1、创建 p 
var pDom=document.createElement("p");
// 2、p 的内容 
    pDom.innerText="哈哈哈哈";
    pDom.style.color="red";
// 3、 获取div
var divDom=document.getElementById("box");
// 4、获取h1
var h1Dom= divDom.firstElementChild;
// 5、将 p 添加到 div内 h1之前
divDom.insertBefore( pDom,h1Dom ); 
```



#### 8.3.3替换

​	父节点.replaceChild(新节点，老节点) 

```html
<div id="box">
    <h1 id="h1">123</h1>
</div>
```

​	

```js
// 将 h1 标签 替换为 p 标签

//1、 创建p标签
var pDom=document.createElement("p");
//2、 p标签内容 == h1 内容
//2-1、获取 h1 标签
var h1Dom=document.getElementById("h1");
//2-2、获取 h1 的内容
var h1Text=h1Dom.innerText;
//2-3、p标签内容 = h1 内容
pDom.innerText= h1Text;

//3、替换 父元素.replaceChild(新节点，老节点) 	
//3-1、获取 父元素 div
var divDom=document.getElementById("box");
    divDom.replaceChild(pDom,h1Dom);
```



#### 8.3.4删除

​	父节点.removeChild(要删除的元素)	 方法可从父节点下的子节点列表中删除某个节点

​	自身节点.remove() 将本身移除掉

```html
<div id="box">
    <h1 id="h1">123</h1>
    <h2 id="h2">456</h2>
</div>
```

```js
//一 、父节点.removeChild(要删除的元素)	

// 1、获取  父节点 div
var divDom=document.getElementById("box");
// 2、获取  要删除的元素
var h1Dom=document.getElementById("h1");
// 3、删除
divDom.removeChild(h1Dom)
```

```js
// 二、自身节点.remove() 将本身移除掉

// 1、获取  要删除的元素
var h2Dom=document.getElementById("h2");
// 2、删除
h2Dom.remove();
```



#### 8.3.5克隆

DOM1.cloneNode(boolean) : 复制一个节点
true：深复制，复制节点及其整个子节点树
false : 浅复制，只复制节点本身。默认是false

```html
<div id="box">
    <h1 id="h1">123</h1>
</div>
```

```js
// 克隆 h1 -- 添加到 box 内部末尾
// 1、获取 h1
var h1Dom=document.getElementById("h1");
// 2、克隆 DOM1.cloneNode(boolean) 
// true：深复制，复制节点及其整个子节点树
// false : 浅复制，只复制节点本身。默认是false
var ch1Dom=h1Dom.cloneNode(true);
// console.log(ch1Dom)
//3、将 克隆 得到的元素 放入 box 内部末尾
//3-1、获取 box
var divDom=document.getElementById("box");
//3-2、父节点.appendChild(克隆得到的元素)
    divDom.appendChild(ch1Dom);
```

### 8.3.6    !!!!案例--在一个文本框创建输入个数的按钮

```html
<style>
        #btnBox{
            width: 500px;
            height: 500px;
            border: 1px solid red;
        }
    </style>
</head>
<body>
   
    <div id="box">
        <span>创建</span>
            <input type="text" id="num" autofocus>
        <span>个 按钮</span>
        <button id="start">开始创建</button>
    </div>

    <div id="btnBox">
  </div>
```

```js
// 1、获取 开始创建按钮
var startDom=document.getElementById("start")
// 2、给 开始创建按钮 绑定 点击事件
    startDom.onclick=function(){
        // ---- 清空 div
        var btnBoxDom=document.getElementById("btnBox");
        btnBoxDom.innerText=""
         // 3、事件内 获取 input 框输入的 值
        var inputDom=document.getElementById("num");
        //  转数字类型
        var num= parseInt( inputDom.value );
        // 判断输入的是不是数字
        if(num){
            console.log("输入的是数字",num);
            // 4、创建 num 个 button
            for(var i=0;i<num;i++){
                // 创建的button 按钮
                var btnDom=document.createElement("button");
                    btnDom.innerText= "按钮" + (i+1);
                    // console.log(btnDom);
             
                // 5、分别 添加到 id="btnbox" 的div 中
                // var btnBoxDom=document.getElementById("btnBox");
                btnBoxDom.appendChild(btnDom);
            }
             
        }else{
            alert("必须输入数字");
            inputDom.value=""; //清空输入框
            inputDom.focus(); // input框获得鼠标焦点
        }
        
           
    }
```



### 8.4  偏移量

元素的可见大小由其高度、宽度决定，包括所有内边距、滚动条和边框的大小（注意，不包括外边距）。

**offsetHeight**：元素在垂直方向上占用的空间大小，以像素计。

​		包括元素的高度、水平滚动条的高度、上边框高度和下边框的高度。

**offsetWidth**：元素在水平方向上占用的空间大小，以像素计。

​		包括元素的宽度、垂直滚动条的宽度、左边框宽度和右边框宽度。

**offsetLeft**：元素的左外边框至包含元素的左内边框之间的像素距离。

**offsetTop**：元素的上外边框至包含元素的上内边框之间的像素距离。

```html
<style>
        *{
            margin: 0;
            padding: 0;
        }
        #box{
            width: 200px;
            height: 100px;
            border: 1px solid black;
            padding: 10px;
            margin: 100px;
        }
    </style>
</head>
<body>
    <div id="box">1</div>
```

```js
var divDom=document.getElementById("box");
console.log("左边框--> body左边距离",divDom.offsetLeft);
console.log("上边框--> body上边距离",divDom.offsetTop);
console.log("内容+内边距+边框 水平方向上占用的空间大小",divDom.offsetWidth);
console.log("内容+内边距+边框  垂直方向上占用的空间大小",divDom.offsetHeight);
```



### 8.5.客户/可视区大小

元素的客户区大小指的是元素内容及其内边距所占据的空间大小。

**clientWidth**：元素内容区宽度加上左右内边距宽度。

**clientHeight**：元素内容区高度加上上下内边距高度。

```html
<style>
        *{
            margin: 0;
            padding: 0;
        }

        #box{ 
            width: 200px;
            height: 100px;
            border: 3px solid black;
            padding: 10px;
            margin: 100px;
        }

    </style>
</head>
<body>
    <div id="box">1</div>
```

```js
var divDom= document.getElementById("box");
console.log("div 内容+内边距 宽",divDom.clientWidth );
console.log("div 内容+内边距 高",divDom.clientHeight)
console.log( "body 可视区域 宽",document.documentElement.clientWidth );
console.log( "body 可视区域 高",document.documentElement.clientHeight );
```



### 8.6 .滚动大小

**scrollHeight**：在没有滚动条的情况下，元素内容的总高度。（包括隐藏的高度）

**scrollWidth**：在没有滚动条的情况下，元素内容的总宽度。（包括隐藏的宽度）

**scrollLeft**：被隐藏在内容区域左侧的像素数。

**scrollTop**：被隐藏在内容区域上方的像素数。

因此，带有垂直滚动条的页面的总高度就是document.documentElement.scrollHeight。

对于不包含滚动条的页面而言，scrollWidth和scrollHeight与clientWidth和clientHeight之间的关系并不十分清晰，浏览器之间的差异很大。

Firefox中这两组属性始终都是相等的，都代表文档内容区域尺寸，而非视口尺寸；

Opera、Safari 3.1及更高版本、Chrome中这两组属性是有差别的，其中scrollWidth和scrollHeight等于视口大小，而clientWidth和clientHeight等于文档内容区域大小；

IE(标准模式)中，scrollWidth和scrollHeight等于文档内容区域大小，而clientWidth和clientHeight等于视口大小。

因此在确定文档的总高度时，取两个值的最大值。

scrollTop和scrollLeft是可以设置的。

```html
<style>
        *{
            margin: 0;
            padding: 0;
        }
        .one{
            height: 300px;
            border: 1px solid red;
            text-align: center;
            line-height: 300px;
        }
     
    </style>
</head>
<body>
    <div class="one">1</div>
    <div class="one">2</div>
    <div class="one">3</div>
    <div class="one">4</div>
    <div class="one" id="x">5</div>
```

```js
var xDom=document.getElementById("x");
//滚动事件
window.onscroll=function(){
    console.log(document.documentElement.scrollTop);// 被隐藏 的 内容高度 -- 卷起的内容高度
}
```

### 8.7  !!!案例-----回到顶部

```html
<style>
        *{
            margin: 0;
            padding: 0;
        }
        .one{
            height: 200px;
            border: 1px solid red;
            text-align: center;
            line-height: 300px;
            background: violet;
        }
        /* 回到顶部小盒子的属性设置 */
        #backTop{
            width: 80px;
            height: 80px;
            background: red;
            text-align: center;
            line-height: 80px;
            color: white;
            position:fixed;
            bottom: 50px;
            right: 0;
            display: none;
        }
     
    </style>
</head>
<body>
    <div class="one">1</div>
    <div class="one">2</div>
    <div class="one">3</div>
    <div class="one">4</div>
    <div class="one">5</div>
    <div class="one">6</div>
    <div class="one">7</div>

    <div id="backTop" >回到顶部</div>
```

```js
var backTopDom=document.getElementById("backTop");

// 滚动时 出现 回到顶部 div
window.onscroll=function(){
    var sTop=document.documentElement.scrollTop;
    if(sTop > 50){
        backTopDom.style.display ="block";
    }else{
        backTopDom.style.display ="none";
    }

// 点击 回到顶部时  scrollTop=0; 
backTopDom.onclick=function(){
    document.documentElement.scrollTop=0; 
}
}
```

### 8.8  图片懒加载

```html
    <style>
        .img{
            width: 200px;
            height: 200px;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div>
<img src="./img/loading.gif"  lazy-src="./img/1.jpg" class="img">
<!-- <img src="./img/1.jpg" class="img"> -->
<img src="./img/loading.gif"  lazy-src="./img/2.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/3.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/4.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/5.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/6.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/7.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/8.gif" class="img">
<img src="./img/loading.gif"  lazy-src="./img/9.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/10.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/11.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/12.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/13.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/14.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/15.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/16.jpg" class="img">
<img src="./img/loading.gif"  lazy-src="./img/17.jpg" class="img">

    </div>
```

```js
// 怎么判断 图片进入 可视区域 
// 图片.offsetTop <  （可视区域高度 + 滚动卷起的高度）
function lazy(){
    var imgDom=document.querySelectorAll(".img");
    var h=document.documentElement.clientHeight;
    var s=document.documentElement.scrollTop
    for(var i =0;i<imgDom.length;i++){
        // 图片.offsetTop <  （可视区域高度 + 滚动卷起的高度）
        if(imgDom[i].offsetTop < ( s+ h ) ){
            var lazySrc= imgDom[i].getAttribute("lazy-src");
            // console.log(lazySrc)
                imgDom[i].setAttribute("src",lazySrc);
        }
    }
}
window.onload=function(){
    lazy()
}
window.onscroll=function(){
   lazy()
}
```

# 2.9 

### 9.1  事件委托

```html
<ul id="ul">
    <li>11</li>
    <li>22</li>
    <li>33</li>
    <li>44</li>
    <li>55</li>
    <li>66</li>
    <li>77</li>
    <li>88</li>
    <h1>哈哈哈哈哈哈哈哈哈哈哈</h1>
</ul>
```

```js
/*
    var liDom=document.querySelectorAll("li");
    console.log(liDom)
    for(var i=0;i<liDom.length;i++){
        liDom[i].onclick=function(){
            console.log( this.innerText )
        }
    }
*/
var ulDom= document.getElementById("ul")
    ulDom.onclick=function(e){
        // 发生事件 元素的事件对象
        // e.target  发生事件的元素 <li> ... </li>
        // console.log( e.target.tagName )
        if( e.target.tagName == "LI"){
            console.log(e.target.innerText);
        }
       
    }
```

### 9.2 !!!案例 学生管理系统  

###### 方法1   方法2

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
       .table{
            border-collapse: collapse;
            width: 500px;
            text-align: center;
       }
       .table td ,.table th{
        border: 1px solid #000;
       }
       
    </style>
</head>
<body>
    <form >
        <div>
            <label for="name">姓名</label>
            <input type="text" id="name">
        </div>

        <div>
            <label for="age">年龄</label>
            <input type="text" id="age">
        </div>

        <div>
            <label style="visibility: hidden;">添加 </label>
            <input type="button" value="添加" id="addBtn">
           
        </div>
    </form>

    <table class="table" >
        <thead>
            <tr>
                <th>姓名</th>
                <th>年龄</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody id="tbody">
            <tr>
                <td>11</td>
                <td>13</td>
                <td>
                    <button>删除</button>
                </td>
            </tr>
            <!-- <tr>
                <th colspan="3">暂无数据</th>
            </tr> -->
        </tbody>
    </table>

    <script src="./01.js"></script>
</body>
</html>
```

```js
// 一、点击 添加按钮 获取 姓名、年龄 打印到控制台

// 二、输入框不能为空

// 三、 创建tr ， td 

// ---------------获取添加 按钮 绑定点击事件
var addBtnDom=document.getElementById("addBtn");
//添加
    addBtnDom.onclick=function(){

        // 获取 姓名、年龄 
        var nameDom= document.querySelector("#name");
        var ageDom= document.querySelector("#age");

        var nameVal= nameDom.value;
        var ageVal = ageDom.value;

        //console.log(nameVal,ageVal)

        if(nameVal == "" || ageVal ==""){
            console.log("不能为空");
        }else{
            console.log(nameVal,ageVal)
        }

        if(nameVal && ageVal){
            console.log("有值",nameVal,ageVal);
            // 创建tr 
            var trDom=document.createElement("tr");
            // 创建 td -姓名
            var td1Dom=document.createElement("td");
                td1Dom.innerText=nameVal;
            // 创建 td -年龄
            var td2Dom=document.createElement("td");
                td2Dom.innerText=ageVal;
            //  创建 td -删除按钮
            var td3Dom=document.createElement("td");
            //  创建 button 删除按钮
            var btnDom=document.createElement("button");
                btnDom.innerText="删除"
// 删除 动态添加的 tr
                btnDom.onclick=function(){
                    // console.log(this)
                    this.parentNode.parentNode.remove();    
                }
        //  将 删除按钮 添加都 td 
            td3Dom.appendChild(btnDom);
        //  将 所有td 添加到 tr
        trDom.append(td1Dom,td2Dom,td3Dom);
        // 将tr 添加到tbody
        var tbodyDom=document.getElementById("tbody");
            tbodyDom.appendChild(trDom);
        }else{
            console.log("不能为空")
        }
        nameDom.value="";
        ageDom.value="";
    }
//删除 默认已经有的 tr
var btnDom=document.getElementsByTagName("button");
// console.log(btnDom)
for(var i =0;i<btnDom.length;i++){
    btnDom[i].onclick=function(){
        this.parentNode.parentNode.remove()
    }
}
```

###### 方法2

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
       .table{
            border-collapse: collapse;
            width: 500px;
            text-align: center;
       }
       .table td ,.table th{
        border: 1px solid #000;
       }
       
    </style>
</head>
<body>
    <form >
        <div>
            <label for="name">姓名</label>
            <input type="text" id="name">
        </div>

        <div>
            <label for="age">年龄</label>
            <input type="text" id="age">
        </div>

        <div>
            <label style="visibility: hidden;">添加 </label>
            <input type="button" value="添加" id="addBtn">
           
        </div>
    </form>

    <table class="table" >
        <thead>
            <tr>
                <th>姓名</th>
                <th>年龄</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody id="tbody">
            <!-- <tr>
                <td>11</td>
                <td>13</td>
                <td>
                    <button>删除</button>
                </td>
            </tr> -->
            <!-- <tr>
                <th colspan="3">暂无数据</th>
            </tr> -->
        </tbody>
    </table>

    <script src="./02.js"></script>
</body>
</html>
```



```js
// --------------------------------
//1、布局 

// 2、初始渲染 
// 2-1、模拟默认数据
var arr=[
    {"id":1,"name":"11","age":13},
    {"id":2,"name":"22","age":14},
    {"id":3,"name":"33","age":15}
]

// 2-2、渲染

function show(arr){
    var str="";
    for(var i=0;i<arr.length;i++){
        str+=`
        <tr>
            <td>${ arr[i].name }</td>
            <td>${ arr[i].age}</td>
            <td>
                <button onclick="del(${i})">删除</button>
            </td>
        </tr>
        `
    }
    // console.log(str);
    document.getElementById("tbody").innerHTML= str;
}
show(arr);

//删除
function del(i){
    arr.splice(i,1);
    show(arr);
}

// 3、事件
var addBtnDom=document.getElementById("addBtn");
    addBtnDom.onclick=function(){
        var nameDom=document.getElementById("name");
        var ageDom=document.getElementById("age");

        var nameVal=nameDom.value;
        var ageVal=ageDom.value;

        // console.log(nameVal, ageVal);
        if( nameVal && ageVal ){
            
            arr.push( {"id":new Date().getTime(),"name":nameVal,"age":ageVal} )
            // console.log(arr);
            show(arr);
        }else{
            alert("不能为空");
        }
    }
```

```js
    //封装 setCookie(属性名,属性值,失效时间)
    function setCookie(key,value,time){
        var d=new Date();
        d.setTime( d.getTime() + time*60*1000 ) ;
        document.cookie =`${key}=${value};expires=${d.toGMTString()}`
    }
    setCookie("name","高",2);
    setCookie("age",18,2);
    
   //封装 getCookie(属性名)  
   function getCookie(key){
        var c= document.cookie;//name=高; namexx=18
        var arr= c.split(";");
        var index=  arr.findIndex(function(v){
                return v.includes(key+"=")
            })
        return  index >=0 ?  arr[index].split("=")[1] : "";
   }

   //   getCookie("age")
   console.log(  getCookie("name") );
```

### 9.2cookie

```js
// 设置
var d= new Date(); //获取当前日期对象  d.getTime()  获取时间戳 1970到现在的毫秒
d.setTime( d.getTime() + 10*1000 );// 俩分钟
document.cookie="user=gao; expires="+ d.toGMTString()
// 获取
console.log(document.cookie);
```

### 9.3  设置cookie

```js
    //封装 setCookie(属性名,属性值,失效时间)
    function setCookie(key,value,time){
        var d=new Date();
        d.setTime( d.getTime() + time*60*1000 ) ;
        document.cookie =`${key}=${value};expires=${d.toGMTString()}`
    }
    setCookie("name","高",2);
    setCookie("age",18,2);
    
   //封装 getCookie(属性名)  
   function getCookie(key){
        var c= document.cookie;//name=高; namexx=18
        var arr= c.split(";");
        var index=  arr.findIndex(function(v){
                return v.includes(key+"=")
            })
        return  index >=0 ?  arr[index].split("=")[1] : "";
   }

   //   getCookie("age")
   console.log(  getCookie("name") );
```

### 9.4  localStorage

持久化存储,5M左右,不主动删除,一直存在(历史记录)

设置:  setItem(key,value),其中value必须为字符串

获取:  getItem(key)

```js
// 设置 
localStorage.setItem("x","啊啊啊啊啊啊啊啊")

localStorage.setItem("y","aaaaa")

//获取
console.log(  localStorage.getItem("x") ) 

// 删除
// localStorage.removeItem("x");

// 清空
// localStorage.clear();
sessionStorage.setItem("aaaa","yyyyyy")
```

### 9.5  json  

```js
var obj={"name":"aa","age":13};
var str= JSON.stringify( obj )
console.log( str );

var obj2= JSON.parse(str);
console.log( obj2 );


// JSON 对象 -- 转为 JSON 字符串
// JSON.stringify()

// JSON 字符串 -- 转为 JSON 对象
// JSON.parse()

// localStorage.setItem("user",JSON.stringify( obj ) )

// console.log(  JSON.parse(  localStorage.getItem("user") )  )
```

### 9.6  案例--渲染

```html
<input type="text" id="todo">
<button id="add">添加</button>
<ul id="ul">
    <!-- <li>22</li>
    <li>33</li>
    <li>44</li> -->
</ul>
```

```js
  //1、布局
  //2、渲染
  //2-1、模拟默认数
  //     ---  获取 本地储存 ?如果有 转JSON对象 取值 :如果没有 []
  var arr = localStorage.getItem("anli") ? JSON.parse(localStorage.getItem("anli")).zhi : []
  //2-2、循环数组 拼接 模版字符串 - 添加dom
  function show() {
      var str = ""
      for (var i = 0; i < arr.length; i++) {
          str += `
          <li>${arr[i]}</li>
      `
      }
      console.log(str);
      document.getElementById("ul").innerHTML = str;
   }
  show()
  //3、事件
  var addDom = document.getElementById("add");
  addDom.onclick = function () {
      var inputDom = document.getElementById("todo");
      var inputVal = inputDom.value;
      // console.log(inputVal);
      arr.push(inputVal);
      // 1-------
      var obj = {
          "zhi": arr
      };
      localStorage.setItem("anli", JSON.stringify(obj));
      show()
  }
```

# 2.10  

### 10.1案例  表单元素( 单选-文本- 多选-下拉-文本域)

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form >
        <div>     
            <label for="">姓名:</label>
            <input type="text" name="" id="user">
        </div>

        <div>
            <label for="">性别:</label>
           <span>男</span> <input type="radio" name="sex"  value="男" checked>
           <span>女</span> <input type="radio" name="sex"  value="女">
        </div>

        <div>
            <label for="">籍贯:</label>
            <select name="" id="address">
                <option value="陕西">陕西省</option>
                <option value="山西">山西省</option>
                <option value="河南">河南省</option>
                <option value="河北">河北省</option>
            </select>
        </div>

        <div>
            <label for="">爱好:</label>
            <span>看代码</span> <input type="checkbox" name="hobby"  value="看代码">
            <span>抄代码</span> <input type="checkbox" name="hobby"  value="抄代码">
            <span>写代码</span> <input type="checkbox" name="hobby"  value="写代码">

        </div>  
        
        <div>
            <label for="">介绍:</label>
            <textarea name="" id="msg" cols="30" rows="10"></textarea>
        </div>
        <div>
            <input type="button" value="提交" id="add">
        </div>

    </form>


    <script src="./06.js"></script>
</body>
</html>
```

```js
var class2103 = [];


// 绑定点击事件
var addDom = document.getElementById("add");
addDom.onclick = function () {
    // 姓名 基础
    var userDom = document.getElementById("user");
    var user = userDom.value;
    // console.log("姓名",user);

    // 性别 单选
    var sexDom = document.getElementsByName("sex");
    var sex;
    for (var i = 0; i < sexDom.length; i++) {
        if (sexDom[i].checked == true) {
            sex = sexDom[i].value
        }
    }
    // console.log("性别",sex);

    // 籍贯  下拉
    var addressDom = document.getElementById("address");
    var address = addressDom.value;
    // console.log("籍贯",address);

    // 爱好  复选

    var hobbyDom = document.getElementsByName("hobby");
    var hobby = [];
    for (var i = 0; i < hobbyDom.length; i++) {
        if (hobbyDom[i].checked == true) {
            hobby.push(hobbyDom[i].value)
        }
    }
    // console.log("爱好",hobby);

    // 介绍  文本域
    var msgDom = document.getElementById("msg");
    var msg = msgDom.value;
    // console.log("自我介绍",msg);


    // 非空验证
    if (user && sex && address && hobby.length > 0 && msg) {
        // console.log('输入正确');
        var obj = {
            "user": user,
            "sex": sex,
            "address": address,
            "hobby": hobby,
            "msg": msg
        }
        //  console.log(obj);
        class2103.push(obj);

        console.log(class2103);

    } else {
        console.log("输入错误，有未填写");
    }


}
```

### 10.2  案例  显示与隐藏

```html
<style>
        #editOk {
            display: none;
        }
    </style>
</head>

<body>
    <button id="add">添加</button>
    <button id="editok">确认修改</button>
    <ul>
        <li id="edit">修改</li>
    </ul>
```

```js
// 点击 li 修改 ， 隐藏 添加 按钮 ，展示 确认修改
        var editDom = document.getElementById("edit"); // li 修改 
        var addDom = document.getElementById("add"); // 添加按钮
        var editOkDom = document.getElementById("editOk"); // 确认修改
        editDom.onclick = function () {
            addDom.style.display = "none";
            editOkDom.style.display = "block";
        }
        // 点击 确认修改  隐藏自己，显示 添加按钮
        editOkDom.onclick = function () {
            this.style.display = "none";
            addDom.style.display = "block";

        }
```

### 10.3  渲染--1

```html
    <div>
        <p>姓名 ：<span id="user">xx</span> </p>
        <p>性别 ：<span id="sex">xx</span> </p>
        <p>年龄 ：<span id="age">xx</span> </p>

    </div>

    <script>
        var one = {
            "name": "gao",
            "age": 18,
            "sex": "男"
        }

        var userDom = document.getElementById("user");
        userDom.innerHTML = one.name;

        var sexDom = document.getElementById("sex");
        sexDom.innerHTML = one.sex;

        var ageDom = document.getElementById("age");
        ageDom.innerHTML = one.age;
    </script>
```

### 10.4  渲染  --2

```html
<style>
        #box>div {
            border: 1px solid black;
            margin-bottom: 5px;
        }
    </style>
</head>

<body>
    <div id="box">
        <!-- <div >
        <p>姓名 ：<span id="user">xx</span> </p> 
        <p>性别 ：<span id="sex">xx</span> </p> 
        <p>年龄 ：<span id="age">xx</span> </p> 

    </div> -->

    </div>


    <script>
        var arr = [{
                "name": "gao",
                "age": 18,
                "sex": "男"
            },
            {
                "name": "gao2",
                "age": 182,
                "sex": "男"
            },
            {
                "name": "gao3",
                "age": 183,
                "sex": "男"
            },
        ]

        var str = "";
        for (var i = 0; i < arr.length; i++) {
            str += `
            <div >
                <p>姓名 ：<span id="user">${arr[i].name}</span> </p> 
                <p>性别 ：<span id="sex">${arr[i].sex}</span> </p> 
                <p>年龄 ：<span id="age">${arr[i].age}</span> </p> 

            </div> 
            `
        }
        document.getElementById("box").innerHTML = str;
    </script>
```

### 10.5  渲染封装

```js
    <style>
        #box>div {
            border: 1px solid black;
            margin-bottom: 5px;
        }
    </style>
</head>

<body>
    <div id="box">
        <!-- <div >
        <p>姓名 ：<span id="user">xx</span> </p> 
        <p>性别 ：<span id="sex">xx</span> </p> 
        <p>年龄 ：<span id="age">xx</span> </p> 

    </div> -->

    </div>


    <script>
        var arr = [{ "name": "gao","age": 18,"sex": "男"},
            {"name": "gao2","age": 182,"sex": "女"},
            {"name": "gao3","age": 183,"sex": "男"},]

        function show(arr) {
            var str = "";
            for (var i = 0; i < arr.length; i++) {
                str += `
                <div >
                    <p>姓名 ：<span id="user">${arr[i].name}</span> </p> 
                    <p>性别 ：<span id="sex">${arr[i].sex}</span> </p> 
                    <p>年龄 ：<span id="age">${arr[i].age}</span> </p> 

                </div> 
                `
            }
            document.getElementById("box").innerHTML = str;
        }
        show(arr);

        // var x = arr.filter(function(value,index){
        //     return value.sex == "男"
        // })
        // // console.log(x);

        // show(x);
    </script>
```

### 10.6  搜索

```js
<style>
        #box>div {
            border: 1px solid black;
            margin-bottom: 5px;
        }
    </style>
</head>

<body>

    <input type="search" placeholder="请输入姓名" id="sUser"> <button id="search">搜索</button>

    <div id="box">
        <!-- <div >
            <p>姓名 ：<span id="user">xx</span> </p> 
            <p>性别 ：<span id="sex">xx</span> </p> 
            <p>年龄 ：<span id="age">xx</span> </p> 
        </div> -->
    </div>
```

```js
<script>
    var arr = [{
            "name": "gao",
            "sex": "男",
            "age": 19,
        },
        {
            "name": "wang",
            "sex": "男",
            "age": 14,
        },
        {
            "name": "li",
            "sex": "女",
            "age": 16,
        },
        {
            "name": "zhao",
            "sex": "男",
            "age": 13,
        },
    ]
    //--------渲染,拼接字符串显示到页面-------------
    function show(xx) {
        var str = "";
        for (var i = 0; i < xx.length; i++) {
            str += `
            <div >
                <p>姓名 ：<span id="user">${xx[i].name}</span> </p> 
                <p>性别 ：<span id="sex">${xx[i].sex}</span> </p> 
                <p>年龄 ：<span id="age">${xx[i].age}</span> </p> 
            </div>
            `
        }
        document.getElementById("box").innerHTML = str;
    }
    show(arr);
    //-------------获取搜索按钮------------
    var searchDom = document.getElementById("search");
    //------------搜索按钮绑定点击事件-----       
    searchDom.onclick = function () {
        //获取搜索输入框
        var sUserDom = document.getElementById("sUser");
        var sUser = sUserDom.value;
        //数组筛选功能filter,返回复合条件的新数组nArr,
        var nArr = arr.filter(function (value, index) {
            return value.name.includes(sUser)
        })
        show(nArr);
    }
    </script>
```

### 10.7  !!!!案例  学员信息管理系统--增删改查

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        .table {
            border-collapse: collapse;
            width: 100%;
            text-align: center;
        }

        .table th,
        table td {
            border: 1px solid black;
        }

        #editOk {
            display: none;
        }
    </style>
</head>

<body>
    <h1>学员信息管理系统</h1>
    <!-- 录入 -->
    <form>
        <div>
            <label for="">姓名:</label>
            <input type="text" name="" id="user">
        </div>

        <div>
            <label for="">性别:</label>
            <span>男</span> <input type="radio" name="sex" value="男" checked>
            <span>女</span> <input type="radio" name="sex" value="女">
        </div>

        <div>
            <label for="">籍贯:</label>
            <select name="" id="address">
                <option value="陕西">陕西省</option>
                <option value="山西">山西省</option>
                <option value="河南">河南省</option>
                <option value="河北">河北省</option>
            </select>
        </div>

        <div>
            <label for="">爱好:</label>
            <span>看代码</span> <input type="checkbox" name="hobby" value="看代码">
            <span>抄代码</span> <input type="checkbox" name="hobby" value="抄代码">
            <span>写代码</span> <input type="checkbox" name="hobby" value="写代码">

        </div>

        <div>
            <label for="">介绍:</label>
            <textarea name="" id="msg" cols="30" rows="1"></textarea>
        </div>
        <div>
            <input type="button" value="提交" id="add">
            <input type="button" value="确认修改" id="editOk">
        </div>

    </form>
    <hr />
    <!-- 展示 -->
    <table class="table">
        <thead>
            <tr>
                <th>序号</th>
                <th>姓名</th>

                <th>性别</th>
                <th>爱好</th>
                <th>籍贯</th>
                <th>个人介绍</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody id="tbody">
            <!-- <tr>
                <td>序号</td>
                <td>姓名</td>
                <td>年龄</td>
                <td>性别</td>
                <td>爱好</td>
                <td>籍贯</td>
                <td>个人介绍</td>
                <td>
                    <button>删除</button>
                    <button>修改</button>
                </td>
            </tr> -->
        </tbody>
    </table>

    <script src="./07-curd.js"></script>
</body>

</html>
```

```js
// c create    创建    增
// u update    修改    改
// r read      读取    查
// d delete    删除    删


// 1、模拟数据

// var arr=[
//     // {
//     //     "id":1,
//     //     "user":"gao",
//     //     "sex":"女",
//     //     "hobby":['看代码','写代码'],
//     //     "address":"陕西",
//     //     "msg":"人人皆可成才",
//     // },
// ]


var arr= localStorage.getItem("p20610") ? JSON.parse(localStorage.getItem("p20610")  ).info :[];

// 获取 dom 元素
var addDom=document.getElementById("add");
var editOkDom=document.getElementById("editOk");
var userDom=document.getElementById("user");
var sexDom=document.getElementsByName("sex");
var addressDom=document.getElementById("address");
var hobbyDom=document.getElementsByName("hobby");
var msgDom=document.getElementById("msg");


// 2、 渲染

function show( xx ){
    var str="";
    for(var i=0;i<xx.length;i++){
        str+=`
        <tr>
            <td>${i+1}</td>
            <td>${xx[i].user}</td>
    
            <td>${xx[i].sex}</td>
            <td>${xx[i].hobby.join("-")  }</td>
            <td>${xx[i].address}</td>
            <td>${xx[i].msg}</td>
            <td>
                <button onclick="del(${i})">删除</button>
                <button onclick="edit(${i})">修改</button>
            </td>
        </tr>
        `
    }
    document.getElementById("tbody").innerHTML=str;

}
show(arr);


// 3、 事件操作
// 添加
addDom.onclick=function(){
    var user=userDom.value;
    var sex ;
    for(var i =0;i<sexDom.length;i++){
        if(sexDom[i].checked == true){
            sex= sexDom[i].value;
        }
    }
    var address= addressDom.value;
    var hobby=[];
        for(var j=0;j<hobbyDom.length;j++){
            if(hobbyDom[j].checked == true){
                hobby.push( hobbyDom[j].value )
            }
        }
    var msg=msgDom.value;
if(user && sex && hobby.length>0 && address && msg){
    var obj={
        "id":new Date().getTime(),
        "user":user,
        "sex":sex,
        "hobby":hobby,
        "address":address,
        "msg":msg,
    }

    arr.push(obj);

    localStorage.setItem("p20610",JSON.stringify( { "info":arr } ))
    show(arr);
}else{
    alert("不能为空");
}

}
// 删除
function del(index){
    arr.splice(index,1);
    localStorage.setItem("p20610",JSON.stringify( { "info":arr } ))
    show(arr);
}

// 修改
var editIndex;

function edit(index){
    editOkDom.style.display="block";
    addDom.style.display="none";

    // i 是修改时 下标
    // console.log( arr[i] );

    var obj= arr[index];

    userDom.value=obj.user;

    for(var i=0;i<sexDom.length;i++){
        // console.log(sexDom[i].value ,obj.sex)
        if( sexDom[i].value == obj.sex ){
            // console.log("sssss")
            sexDom[i].checked=true;
        }
    }

    addressDom.value=obj.address;

    for(var x=0;x<hobbyDom.length;x++){

        for(var y=0;y<obj.hobby.length;y++){
            if( hobbyDom[x].value == obj.hobby[y] ){
                hobbyDom[x].checked=true;
                break;
            }
        }
    }

    msgDom.value= obj.msg;
    editIndex =index;

}

// 确认修改

 editOkDom.onclick=function(){
    editOkDom.style.display="none";
    addDom.style.display="block";

    var user=userDom.value;
    var sex ;
    for(var i =0;i<sexDom.length;i++){
        if(sexDom[i].checked == true){
            sex= sexDom[i].value;
        }
    }
    
    var address= addressDom.value;
    var hobby=[];
        for(var j=0;j<hobbyDom.length;j++){
            if(hobbyDom[j].checked == true){
                hobby.push( hobbyDom[j].value )
            }
        }
    var msg=msgDom.value;
    
    if(user && sex && hobby.length>0 && address && msg){
        var obj={
            "id":new Date().getTime(),
            "user":user,
            "sex":sex,
            "hobby":hobby,
            "address":address,
            "msg":msg,
        }

        arr[editIndex] = obj;
        // console.log(editIndex)

        localStorage.setItem("p20610",JSON.stringify( { "info":arr } ))

        show(arr);

// 清空表单

        userDom.value="";
        msgDom.value="";


    }else{
        alert("不能为空"); 

    }
}


```

# 2.11

### 11.1  onload

```js
 window.onload = function () {
     console.log("onload-1");
 }
```

### 11.2  onerror

```js
  function errorFn() {
      console.log("错误");
      // console.log(event)
      event.target.src = "./3.jpg"
  }
```

### 11.3   onresize

```js
  window.onresize = function () {
      console.log("改变大小了");
  }
```

### 11.4  鼠标单击onclick    双击ondblclick

```js
  var oneDom = document.getElementById("one");
  oneDom.onclick = function () {
      console.log("one 单击");
  }
  oneDom.ondblclick = function () {
      console.log("one 双击");
  }
```

### 11.5  鼠标事件  

```js
  var box = document.getElementById("box");
  box.onmousedown = function () {
      console.log("按下了鼠标");
  }
  box.onmouseup = function () {
      console.log("释放按下鼠标键触发 -抬起/松开");
  }
  box.onmouseenter = function () {
      console.log(" 鼠标 进入 节点触发");
  }
  box.onmouseout = function () {
      console.log(" 鼠标 离开 节点触发");
  }
  box.onmousemove = function () {
      console.log(" 鼠标在节点内部移动触发");
  }
  box.oncontextmenu = function () {
      console.log(" 打开菜单 =点击右键");
  }
  box.onwheel = function (e) {
      console.log("滚轮 滚动", e.wheelDelta);
  }
```

### 11.6  键盘事件

```js
  var userDom = document.getElementById("user");
  userDom.onkeydown = function (e) {
      console.log("按下", e.keyCode) // 按键都可以 
      //keyCode 按键码 1 --- 49  回车 --13  删除del--8
      if (e.keyCode == 13) {
          console.log("按下了回车")
      }
  }
  // userDom.onkeyup=function(){
  //     console.log("松开")
  // }
  userDom.onkeypress = function () {
      console.log("按下") // 按下有值的键触发 
  }
```

### 11.7  表单事件

```js
<form onsubmit="tijiao()" onreset="chongzhi()">
        <input type="text" id="user">
        <input type="submit" value="提交">
        <input type="reset" value="重置">
    </form>
    <script>
        function tijiao() {
            console.log("点击了提交按钮");
        }
        function chongzhi() {
            console.log("点击了重置按钮");
        }
        var userDom = document.getElementById("user");
        userDom.onfocus = function () {
            console.log("onfocus -获得焦点");
        }
        userDom.onblur = function () {
            console.log("onblur--失去焦点");
        }
        userDom.onchange = function () {
            console.log("onchange- 该事件在表单元素的内容改变时触发");
        }
        userDom.oninput = function () {
            console.log("oninput --元素获取用户输入时触发 ")
        }
        userDom.onselect = function () {
            console.log("onselect - 用户选取文本时触发 ")
        }
```

### 11.8 触屏事件

```html
<style>
        #box {
            width: 100px;
            height: 100px;
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <div id="box"></div>
    <script>
        var boxDom = document.getElementById("box");
        boxDom.ontouchstart = function () {
            console.log("手指刚接触屏幕时触发 ")
        }
        boxDom.ontouchmove = function () {
            console.log("手指在屏幕上移动时触发  ")
        }
        boxDom.ontouchend = function () {
            console.log("手指从屏幕上移开时触发  ")
        }
    </script>
```

### 11.9  事件对象

```js
        function btn() {
            var e = event || window.event;
            console.log(e);
        }
        var btn2Dom = document.getElementById("btn2");
        btn2Dom.onclick = function (event) {
            var e = event || window.event;
            console.log(e);
            console.log(e.target, "发生事件的元素");
            console.log(e.screenX, e.screenY, "距离屏幕x,y");
            console.log(e.pageX, e.pageY, "距离文档x,y");
            console.log(e.clientX, e.clientY, "可视区域x,y")
        }
```

### 11.10 !!!案例 todolist  看着像文本-双击即可编辑

```js
        /* #y{
            display: none;
        } */  //css样式


<span id="x">111111  </span>
<input type="text" id="y">
   //--------------------------
        var xDom=document.getElementById("x");
        var yDom=document.getElementById("y");
        xDom.ondblclick=function(){
            this.style.display="none";
            yDom.style.display="block";
            yDom.value= this.innerText;
            yDom.focus();
        }
        yDom.onblur=function(){
            this.style.display="none";
            xDom.style.display="block";  
            xDom.innerText= yDom.value;
        }
        yDom.onkeydown=function(){
            var e= event || window.event;
            if(e.keyCode == 13){
                this.style.display="none";
                xDom.style.display="block";  
                xDom.innerText= yDom.value;
            }
        }
```

### 11.11  事件绑定

```js
 //1第一种事件绑定
  function btn1() {
      console.log("点击了按钮1");
  }

  // 2第二种事件绑定
  var btn2 = document.getElementById("btn2");
  btn2.onclick = function () {
      console.log("点击了按钮2");
  }
  btn2.onmouseover = function () {
      console.log("鼠标在按钮上");
  }
  // 取消事件
  btn2.onmouseover = false;

  // 3  -第三种事件绑定
  var btn3 = document.getElementById("btn3");
  btn3.addEventListener("click", function () {
      console.log("点击了按钮3");
  })
  var fn = function () {
      console.log("鼠标在按钮上3");
  }
  btn3.addEventListener("mouseover", fn)

  // 4-取消事件
  btn3.removeEventListener("mouseover", fn);
```

### 11.12  默认事件

```html
    <form action="" onsubmit="fn()">
        <input type="text" name="user">
        <button>提交 </button>
        <input type="submit" value="提交">
    </form>
    <script>
        function fn() {
            var event = event || window.event;
            // 阻止默认事件
            // event.preventDefault();
            event.returnValue = false;
        }
    </script>
```

### 11.13  事件冒泡

```html
    <style>
  #box {
      width: 300px;
      height: 100px;
      border: 1px solid black;
      display: flex;
  }

  #item {
      width: 100px;
      height: 100px;
      border: 1px solid red;
      margin-left: 200px;
  }
    </style>
</head>

<body>
    <div id="box" onclick="boxFn()">
        <h1>高</h1>
        <div id="item" onclick="itemFn()">删除</div>
    </div>
    <script>
        function boxFn() {
            console.log("进入聊天页面")
        }

        function itemFn() {
            console.log("删除联系人 ")
            var e = event || window.event;
            // 阻止事件 冒泡
            e.stopPropagation();
        }
    </script>
```

### 11.14  事件委托

```html
<style>
#box{
            width: 300px;
            height: 100px;
            border: 1px solid black;
            display:flex;
        }
        #item{
            width: 100px;
            height: 100px; 
            border: 1px solid red;
            margin-left: 200px;
        }
    </style>
</head>
<body>
    <div id="box" onclick="boxFn()">
        <h1>高</h1>
        <div id="item" >删除</div>
    </div>
    <script>
        function boxFn(){
            console.log("进入聊天页面");    
            var e= event||window.event;
            // console.log(e.target);
            if( e.target.id == "item" ){
                console.log("删除联系人");
            }
        }
```

### 11.15  循环变量

```js
  // 如果 循环 变量  是以 var 声明 ，那么 会暴露出一个 全局变量 ，全局变量的值是 循环的终止条件
  for (var i = 0; i < 5; i++) {
      setTimeout(function () {
          console.log(i); // 打印5次  
      }, 1000)
  }
  for (var i = 0; i < 5; i++) {
      (function (i) {
          setTimeout(function () {
              console.log(i); // 打印5次  
          }, 1000)
      })(i)
  }
  /*
          for(let i=0;i<5;i++){
              setTimeout(function(){
                  console.log(i); // 打印5次  
              },1000)
          }
  */
```

### 11.15  闭包应用之tab切换

```html
  <ul id="ul">
      <li>111</li>
      <li>222</li>
      <li>333</li>
      <li>444</li>
  </ul>
  <script>
      var lisDom = document.querySelectorAll("#ul>li");
      for (var i = 0; i < lisDom.length; i++) {
          //闭包
          (function (i) {
              lisDom[i].onclick = function () {
                  console.log(i);
              }
          })(i)
      }
    </script>
```

### 11.16  tab切换-选项卡

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        *{
            margin: 0;
            padding: 0;
            list-style: none;
        }
        #ul{
            width: 300px;
            display: flex;
            justify-content: space-around;
            cursor: pointer;
        }
        #ul>li{
            width: 100%;
            text-align: center;
        }
        .active{
            /* color:red */
            background: red;
            color: white;
        }

        #box{
            width: 300px;
            height: 300px;
            border: 1px solid black;
        }

        #box >div{
            display: none;
        }

        #box>.show{
            display: block;
        }
    </style>
</head>
<body>
    <!-- tab 切换 -->
    <ul id="ul">
        <li >话费</li>
        <li class="active">机票</li>
        <li>酒店</li>
    </ul>
    <div id="box">
        <div>我是 话费 的内容</div>
        <div  class="show">我是 机票 的内容</div>
        <div>我是 酒店 的内容</div>
    </div>
    <script>
        var lisDom=document.querySelectorAll("#ul>li");
        var boxDom=document.querySelectorAll("#box>div");
        for(var  i=0;i<lisDom.length;i++){
            (function(i){           
                lisDom[i].onmouseover=function(){
                    for(var j=0;j<lisDom.length;j++){
                        lisDom[j].classList.remove("active");
                        boxDom[j].classList.remove("show");
                    }
                    this.classList.add("active");
                    boxDom[i].classList.add("show");
                    // console.log(i)
                }
            })(i)
        }
    </script>

</body>
</html>
```

### 11.17  案例使用滚轮改变图片大小

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <img src="./3.jpg" alt="" id="img">
    <script>
        var w=100;
        var h=100;
        var imgDom=document.getElementById("img");
        
        window.onload=function(){
            imgDom.style.width =w +"px";
            imgDom.style.height=h +"px";
        }
        imgDom.onwheel=function(){
            var e=event || window.event;
            // console.log( e.wheelDelta)
            if(e.wheelDelta >0 && w >100){
                imgDom.style.width = --w +"px"; 
                imgDom.style.height= --h +"px";
            }else{
                imgDom.style.width = ++w +"px"; 
                imgDom.style.height= ++h +"px";
            }
        }
    </script>
</body>
</html>
```



# 2.12

###  12.1    !!!!!案例(ab切换及增-删-改-查-模态框--案例

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        *{
            margin: 0;
            padding: 0;
            list-style: none;
        }
        .box{
            height: 100vh;
            display: flex;
        }
        .left{
            width: 15vw;
            border: 1px solid black;
        }

        .ul{
            width: 100%;

        }
        .ul >li{
            text-align: center;
            background: coral;
            margin-bottom: 5px;
            line-height: 50px;
            cursor: pointer;
        }
        .ul>.li_active{
            background: pink;
            color: white;
        }
        .right{
            width: 85vw;
        }
        .tab_box >div{
            display: none;
           
        }
        .tab_box >.show{
            display: block;
        }

        .table{
            border-collapse: collapse;
            width: 100%;
            text-align: center;
        }

        .table th,.table td{
            border: 1px solid black;
        }
       #tbody  img{
            width: 50px;
            height: 50px;
        }

        #model{
            width: 100vw;
            height: 100vh;
            position: absolute;
            left: 0;
            top:0;
            background: rgba(0,0,0,0.6);
            display: none;
        }
        #item{
            width: 30vw;
            height: 30vh;
            position: absolute;
            left: 50%;
            top:50%;
            transform: translate(-50%,-50%);
            background: white; 
            text-align: center;
            line-height: 35px;
        }
        #editOk,#editNo{
            width: 45px;
            height: 30px;
            font-size: 12px;
            background:skyblue;
        }
    </style>
</head>
<body>
    <div class="box">
        <div class="left">
            <ul class="ul" id="tab">
                <li >添加</li>
                <li class="li_active">展示</li>
            </ul>
        </div>
        <div class="right">
            <div class="tab_box" id="tab_box">
                <div >
                    <h1>添加页面</h1>
                    <form >
                        <div>
                            <label for="name">商品名:</label>
                            <input type="text" id="name">
                        </div>
                        <div>
                            <label for="img">图片名:</label>
                            <input type="text" id="img">
                        </div>
                        <div>
                            <label for="price">价&emsp;格:</label>
                            <input type="text" id="price">
                        </div>
                        <div>
                            <label for="num">数&emsp;量:</label>
                            <input type="text" id="num">
                        </div>
                        <div>
                                <input type="button" value="添加" id="add">
                            <!-- <input type="submit" value="添加" > -->
                        </div>
                    </form>
                </div>

                <div class="show">
                    <h1>展示页面</h1>

                    <input type="search" id="search" onkeydown="searchFn()">
                    <hr />
                    <table class="table">
                        <thead>
                            <tr>
                                <th>序号</th>
                                <th>商品名</th>
                                <th>图片</th>
                                <th>价格</th>
                                <th>数量</th>
                                <th>小计</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="tbody">
                             <!-- <tr>
                                <td>1</td>
                                <td>苹果</td>
                                <td>
                                    <img src="./img/3.jpg" alt="">
                                </td>
                                <td>10</td>
                                <td>
                                    <button>+</button>
                                    <input type="text" value="1">
                                    <button>-</button>
                                </td>
                                <td>
                                    10
                                </td>
                                <td>
                                    <button>删除</button>
                                    <button>修改</button>

                                </td>
                            </tr> -->
                        </tbody>
                    </table>
                </div>

            </div>

        </div>
    </div>

    <!-- 模态框 -->
    <div id="model">
        <div id="item">
            <form >
                <div>
                    <label for="name">商品名:</label>
                    <input type="text" id="ename">
                </div>
                <div>
                    <label for="img">图片名:</label>
                    <input type="text" id="eimg">
                </div>
                <div>
                    <label for="price">价&emsp;格:</label>
                    <input type="text" id="eprice">
                </div>
                <div>
                    <label for="num">数&emsp;量:</label>
                    <input type="text" id="enum">
                </div>
                <div>
                        <input type="button" value="修改" id="editOk">
                        <input type="button" value="取消" id="editNo">

                    <!-- <input type="submit" value="添加" > -->
                </div>
            </form>
        </div>
    </div>

    <script src="./01.js"></script>
</body>
</html>
```

```js
var lisDom= document.querySelectorAll("#tab>li");
var divDom= document.querySelectorAll("#tab_box>div");

for(let i=0;i<lisDom.length;i++){
    lisDom[i].onclick=function(){
        // console.log("点击了");
        // console.log("i是--下标",i);
        // console.log("this",this);

        for(var j=0;j<lisDom.length;j++){
            lisDom[j].classList.remove("li_active");
            divDom[j].classList.remove("show");
        }

        lisDom[i].classList.add("li_active");
        divDom[i].classList.add("show");
    }
}

// 展示 

//1、模拟数据
// var arr=[
//     {
//         "id":11,
//         "name":"眯眯猫",
//         "img":"./img/1.jpg",
//         "price":10000,
//         "num":2
//     },
//     {
//         "id":22,
//         "name":"歪头猫",
//         "img":"./img/2.jpg",
//         "price":20000,
//         "num":3
//     },
//     {
//         "id":33,
//         "name":"大脸猫",
//         "img":"./img/3.jpg",
//         "price":30000,
//         "num":4
//     }
// ]
var arr= localStorage.getItem("p20615") ? JSON.parse( localStorage.getItem("p20615") ).info :[]
// 渲染
function showTable(res){
    var str="";
    for(var i=0;i<res.length;i++){
        str+=`
        <tr>
            <td>${i+1}</td>
            <td>${res[i].name}</td>
            <td>
                <img src="${res[i].img}"  alt="">
            </td>
            <td>${res[i].price}</td>
            <td>
                <button onclick="jia(${res[i].id})">+</button>
                <input type="text" value="${res[i].num}" oninput="changeNum(${res[i].id})">
                <button onclick="jian(${res[i].id})">-</button>
            </td>
            <td>
            ${res[i].price * res[i].num}
            </td>
            <td>
                <button onclick="del(${res[i].id})">删除</button>
                <button onclick="edit(${res[i].id})">修改</button>
            </td>
        </tr>
        `
    }
    document.getElementById("tbody").innerHTML=str;
}

//删除
function del(id){
    var flag= confirm("确认删除吗");
    if(flag){
          // console.log(id);
            var index= arr.findIndex(function(value){
                return value.id == id
            })
            arr.splice(index,1);
            localStorage.setItem("p20615",JSON.stringify( {"info":arr} ))
            showTable(arr);
    }
 
}
// 加
function jia(id){
    var index= arr.findIndex(function(value){
        return value.id == id
    })

    arr[index].num +=1;
    localStorage.setItem("p20615",JSON.stringify( {"info":arr} ))
    showTable(arr);

}
// 减
function jian(id){
    var index= arr.findIndex(function(value){
        return value.id == id
    })
    if( arr[index].num >1 ){
        arr[index].num -=1;
        localStorage.setItem("p20615",JSON.stringify( {"info":arr} ))
        showTable(arr);
    }else{
        // console.log("sss")
        arr.splice(index,1);
        localStorage.setItem("p20615",JSON.stringify( {"info":arr} ))
        showTable(arr);
    }   

}

// 修改数量
function changeNum(id){
    console.log(id);
    var e= event||window.event;
    // console.log( e.target.value );
    var index= arr.findIndex(function(value){
        return value.id == id
    })

    arr[index].num =e.target.value ;
    localStorage.setItem("p20615",JSON.stringify( {"info":arr} ))
    showTable(arr);

}

window.onload=function(){
    showTable(arr);
}

// 添加

// 1、 点击事件
var addBtn=document.getElementById("add");
    addBtn.onclick=function(){
        var nameDom=document.getElementById("name");
        var imgDom=document.getElementById("img");
        var priceDom=document.getElementById("price");
        var numDom=document.getElementById("num");

        var name= nameDom.value;
        var img= imgDom.value;
        var price= Number(priceDom.value);
        var num=  Number( numDom.value);
        // console.log(name,img,price,num)
        if(name && img && price &&num){

        arr.push({
            "id":new Date().getTime(),
            "name":name,
            "img":`./img/${img}.jpg`,
            "price":price,
            "num":num
        })

        for(var i=0;i<lisDom.length;i++){
            lisDom[i].classList.remove("li_active");
            divDom[i].classList.remove("show");

        }
        lisDom[1].classList.add("li_active");
        divDom[1].classList.add("show");
        localStorage.setItem("p20615",JSON.stringify( {"info":arr} ))
        showTable(arr);

    }else{
        alert("不能为空");
    }

    }
// 2、 获取 input 值
// 3、 数组中添加一个对象
// 4、 调用 渲染页面方法

//修改
var modelDom=document.getElementById("model");
var editIndex; //修改的 aar 下标
function edit(id){
       modelDom.style.display="block";

       var index = arr.findIndex(function(value){
            return value.id == id
       })

       document.getElementById("ename").value= arr[index].name;
       document.getElementById("eimg").value= arr[index].img;
       document.getElementById("eprice").value= arr[index].price; 
       document.getElementById("enum").value= arr[index].num;

       editIndex = index;
   
}

//取消隐藏

var editNoDom=document.getElementById("editNo");
    editNoDom.onclick=function(){  
       modelDom.style.display="none";
        
    }

//确认修改

var editOkDom=document.getElementById("editOk");
    editOkDom.onclick=function(){
        var name = document.getElementById("ename").value
        var img = document.getElementById("eimg").value
        var price = document.getElementById("eprice").value
        var num = document.getElementById("enum").value

        arr[editIndex].name=name;
        arr[editIndex].img=img;
        arr[editIndex].price=price;
        arr[editIndex].num=num;
        modelDom.style.display="none";
        localStorage.setItem("p20615",JSON.stringify( {"info":arr} ))
        showTable(arr);
    }
        //搜索
    function searchFn(){
        var e= event || window.event;
        var s= e.target.value;
        if(e.keyCode == 13){
            var sArr= arr.filter(function(value){
                return value.name.includes(s);          
            })  
            showTable( sArr )
        }
    }
```

### 12-2  数学方法Math()

```js
//常量PI
         console.log(Math.PI);

//最小值
        console.log( Math.min(10,3,2,9,1,888,0,99 )  ); //0

//最大值
        console.log( Math.max(10,3,2,9,1,888,0,99 )  );//888

//向上取整
        console.log( Math.ceil(10.2) ); // 11

//向下取整
        console.log( Math.floor(10.9) ); // 10

//四舍五入
        console.log( Math.round(5.7) ); //6

//sort 排序
        var arr=[9,7,5,3,6];
        var arr2=arr.sort(function(a,b){
            return a-b; // 从小到大
        })
        console.log(arr2);
        console.log("最小值是",arr2[0])

// 冒泡排序
        for(var i=0;i<arr.length;i++){
            for(var j=i+1;j<arr.length;j++){
                if(arr[i]>arr[j]){ // 从小到大
                    var x= arr[i];
                    arr[i]=arr[j];
                    arr[j]=x;
                }
            }
        }
        console.log(arr,"最小值是",arr[0]);
/// ... 操作符
        console.log( Math.min( ...arr ));

//绝对值
        console.log( Math.abs(-9) );

//次幂
        console.log( Math.pow(2,3));

//平方根
        console.log( Math.sqrt(16) );


// 0-1 的 随机数

        console.log( Math.random() )
// 0 --10 的随机数
        console.log( Math.floor(  Math.random()*10 ) )

// 3- 10 Math.floor( Math.random()*(最大值-最小值+1)+最小值 )

        console.log( Math.floor( Math.random()*(10-3+1) +3 )  )
```

### 12-3 创建 Date()

```js
        // 计算机/时间戳 的时间  1970 01 01 00:00:00
        //   东八区            1970 01 01 08:00:00
        //    月  小一  0 1 2 3 4 
        var a= new Date();
        console.log(a); //当前日期

                      // 年 月 日 时分秒
        var b= new Date(2020,0,1,10,2,1);
        console.log(b);

        var c=new Date("2020-1-2 10:02:03");
        console.log( c);


        console.log(typeof a ); // 对象
        console.log("转字符串" ,a.toString() );
        console.log("转为本地时间字符串",a.toLocaleDateString()); //年/月/日
        console.log("转为本地时间字符串",a.toLocaleTimeString());// 上午时:分:秒
        console.log("转为本地时间字符串",a.toLocaleString());//年/月/日上午时:分:秒
```

### 12-4  创建动态时间

```js
//<h1 id="h1"></h1>
        
setInterval(function(){
     var d= new Date();
    document.getElementById("h1").innerText= d.toLocaleString();
},1000);//1000表示1000毫秒=1秒

//  str= `${year}-6-15  10:45:57`
// 2021年6月15日  10:45:57
```

### 13-5  获取日期

```js
        var d= new Date();

        console.log("获取时间戳,1970/1/1 0:0:0到现在的毫秒数", d.getTime() );

        console.log("获取年",d.getFullYear());
        console.log("获取月,月小1",d.getMonth());
        console.log("获取日",d.getDate());

        console.log("获取星期,星期日是0",d.getDay());

        console.log("获取时",d.getHours());
        console.log("获取分",d.getMinutes());
        console.log("获取秒",d.getSeconds());
        console.log("获取毫秒",d.getMilliseconds());
//------------------------------------------------------
        var num = 9;
        // 转为字符串 判断长度  ,如果 长度小于 前面拼接 0 
        console.log( num.toString().length <2 ? "0"+num.toString(): num.toString());

// es6新增字符串方法
// 开头补齐 padStart(长度,补齐值)
// 结尾补齐 padEnd(长度,补齐值) 
        console.log( num.toString().padStart(2,"0") );
```

### 13-6   封装时间格式

```js
function myTime(){
var d= new Date();

var year= d.getFullYear();
var mouth= (d.getMonth()+1).toString().padStart(2,"0");
var dates= d.getDate().toString().padStart(2,"0");

var hours= d.getHours().toString().padStart(2,"0");
var minutes= d.getMinutes().toString().padStart(2,"0");
var seconds= d.getSeconds().toString().padStart(2,"0");
var milliseconds= d.getMilliseconds().toString().padStart(2,"0");

return `${year}年${mouth}月${dates}日 ${hours}:${minutes}:${seconds}:${milliseconds}`;

   }

//   var x=  myTime();

  setInterval(function(){
  document.getElementById("h1").innerText= myTime();
        },1);
```

### 13.7  倒计时

```js
//设置计时器
setInterval(function(){
var nowTime=new Date();
var endTime=new Date('2022-12-31 12:00:00');
if( endTime - nowTime >0){
            
    // console.log(endTime);
   var s= endTime.getTime()- nowTime.getTime();

    var tian= Math.floor( s /( 1000*60*60*24 ) ).toString().padStart(2,"0");
    // console.log("天",tian);

    var shi=  Math.floor( s/(1000*60*60) %24).toString().padStart(2,"0");
    // console.log("时",shi);

    var fen =Math.floor( s/(1000*60)%60 ).toString().padStart(2,"0");
    // console.log("分",fen);

  var miao =Math.floor( s/(1000)%60 ).toString().padStart(2, '0');
   // console.log("秒",miao);
   var haomiao= Math.floor(s%1000);
    // console.log("毫秒",haomiao);
    document.getElementById("h2").innerText=`${tian}天  ${shi}:${fen}:${miao}:${haomiao} `;

  }else{
       document.getElementById("h2").innerText="已经到期了";
     }
 },1);
```

### 13-8  设置日期

```js
        var d= new Date();

        // console.log(d);


        // d.setFullYear('2020');
        // d.setMonth('3');
        // d.setDate('19');
        // d.setHours('19');

        // console.log(d);

        var t= d.getTime();
        console.log( new Date(  t-1000*60*60*24 ) );
```

# 2.13

### 13.1 综合案例之博客管理系统

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .form {
            display: flex;
        }
        .table {
            border-collapse: collapse;
            width: 70vw;
            text-align: center;
        }
        .table th,
        .table td {
            border: 1px solid brown;
        }

        .night {
            background: black;
            color: white;
        }
        #editOk {
            display: none;
        }
    </style>
</head>

<body>
    <h1>XXXX 博客管理系统</h1>
    <!-- 添加 -->
    <div>
        <form class="form">
            <div>
                <label for="title">新闻标题：</label>
                <input type="text" id="title">
            </div>
            <div>
                <label for="msg">新闻内容：</label>
                <input type="text" id="msg">
            </div>
            <div>
                <label for="user">作者姓名</label>
                <select name="" id="user">
                    <option value="张总编">编辑一部</option>
                    <option value="李总编">编辑二部</option>
                </select>
            </div>
            <div>
                <input type="button" value="添加新闻" id="add">
                <input type="button" value="确认修改" id="editOk">

            </div>
        </form>
    </div>
    <!-- 搜索 -->
    <div>
        <label for="">新闻检索：</label>
        <input type="text" id="search">
        <button id="searchBtn">搜索</button>
    </div>

    <button onclick="delAll()">全部删除</button>
    <button onclick="openClose()">开启夜间模式</button>

    <!-- 展示 -->
    <table class="table">
        <thead>
            <tr>
                <th>序号</th>
                <th>新闻标题</th>
                <th>新闻内容</th>
                <th>作者</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody id="tbody">
            <!-- <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <button>删除</button>
                </td>
            </tr> -->
        </tbody>
    </table>
    <script src="./01.js"></script>
</body>

</html>
```

```js
// 初始数据
// var arr=[
//     { "id":1,"title":"aaaa","msg":"aaaaaaaa","user":"张总编" },
//     { "id":2,"title":"bbbb","msg":"bbbbbbbb","user":"张总编" },
//     { "id":3,"title":"cccc","msg":"cccccccc","user":"张总编" },
//     { "id":4,"title":"dddd","msg":"dddddddd","user":"李总编" }
// ];

var arr = localStorage.getItem("p2KaoShi") ? JSON.parse(localStorage.getItem("p2KaoShi")).info : []
//渲染
function show(res) {
    var str = "";
    if (res.length > 0) {

        for (var i = 0; i < res.length; i++) {
            str += `
            <tr>
                <td>${i+1}</td>
                <td>${res[i].title}</td>
                <td>${res[i].msg}</td>
                <td>${res[i].user}</td>
                <td>
                    <button onclick="del(${res[i].id})">删除</button>
                    <button onclick="edit(${res[i].id})">修改</button>

                </td>
            </tr>
            `
        }

    } else {
        str += `
            <tr > <th colspan="5">暂无数据,请添加</th>  </tr>
        `
    }

    document.getElementById("tbody").innerHTML = str;
}
// 页面加载完成调用 渲染方法
window.onload = function () {
    show(arr);
}
// 删除 
function del(id) {
    var index = arr.findIndex(function (v) {
        return v.id == id
    })
    arr.splice(index, 1);
    localStorage.setItem("p2KaoShi", JSON.stringify({
        "info": arr
    }));
    show(arr);
}
//全部删除
function delAll() {
    arr = [];
    localStorage.setItem("p2KaoShi", JSON.stringify({
        "info": arr
    }));
    show(arr);
}
//添加功能
var addDom = document.getElementById("add");
addDom.onclick = function () {
    //  获取表单
    var titleDom = document.getElementById("title");
    var msgDom = document.getElementById("msg");
    var userDom = document.getElementById("user");
    //  获取表单值
    var title = titleDom.value;
    var msg = msgDom.value;
    var user = userDom.value;

    if (title && msg && user) {
        //  添加到数组
        arr.push({
            "id": new Date().getTime(),
            "title": title,
            "msg": msg,
            "user": user
        })
        //  调用渲染表格方法
        localStorage.setItem("p2KaoShi", JSON.stringify({
            "info": arr
        }));
        show(arr);
    } else {
        alert("不能为空");
    }
}

// 开启/关闭夜间模式
var flag = false;

function openClose() {
    flag = !flag;

    var e = event || window.event;

    if (flag == true) {
        document.body.classList.add("night");
        e.target.innerText = "关闭夜间模式";
    } else {
        document.body.classList.remove("night");
        e.target.innerText = "开启夜间模式";
    }
}
// 按下回车搜索
var searchDom = document.getElementById("search");
searchDom.onkeydown = function () {
    // 获取所有tr 
    var trsDom = document.querySelectorAll("#tbody > tr");
    // 获取 搜索框值
    var e = event || window.event;
    var search = searchDom.value;
    // 让所有tr 去除 搜索样式
    for (var j = 0; j < trsDom.length; j++) {
        trsDom[j].style.background = "";
    }
    // 如果 按下 回车 并且 输入框有值 
    if (e.keyCode == 13 && search) {
        // 循环 判断 哪一项 符合
        for (var i = 0; i < arr.length; i++) {
            if (arr[i].title.includes(search) || arr[i].msg.includes(search) || arr[i].user.includes(search)) {
                // 符合 加 背景颜色   
                trsDom[i].style.background = "red";
            } else {
                // 不符合 清除 背景颜色
                trsDom[i].style.background = "";
            }
        }
    }
}

// 点击按钮搜索
var searchBtnDom = document.getElementById("searchBtn");
searchBtnDom.onclick = function () {
    var search = searchDom.value;
    // 获取所有tr 
    var trsDom = document.querySelectorAll("#tbody > tr");
    // 让所有tr 去除 搜索样式
    for (var j = 0; j < trsDom.length; j++) {
        trsDom[j].style.background = "";
    }
    if (search) {
        // 循环 判断 哪一项 符合
        for (var i = 0; i < arr.length; i++) {
            if (arr[i].title.includes(search) || arr[i].msg.includes(search) || arr[i].user.includes(search)) {
                // 符合 加 背景颜色   
                trsDom[i].style.background = "blue";
            } else {
                // 不符合 清除 背景颜色
                trsDom[i].style.background = "";
            }
        }
    }
}

// 点击修改

var editIndex;//定义全局变量,传递下标给修改确认时使用

function edit(id) {
    var index = arr.findIndex(function (v) {
        return v.id == id;
    })
    addDom.style.display = "none";
    document.getElementById("editOk").style.display = "block";

    //  获取表单
    var titleDom = document.getElementById("title");
    var msgDom = document.getElementById("msg");
    var userDom = document.getElementById("user");
    //  获取表单值
    titleDom.value = arr[index].title;
    msgDom.value = arr[index].msg;
    userDom.value = arr[index].user;
    //给修改id全局变量赋值
    editIndex = index;
}


// 确认修改
var editOkDom = document.getElementById("editOk");
editOkDom.onclick = function () {
    //  获取表单
    var titleDom = document.getElementById("title");
    var msgDom = document.getElementById("msg");
    var userDom = document.getElementById("user");
    //  获取表单值
    var title = titleDom.value;
    var msg = msgDom.value;
    var user = userDom.value;

    arr[editIndex].title = title;
    arr[editIndex].msg = msg;
    arr[editIndex].user = user;
    localStorage.setItem("p2KaoShi", JSON.stringify({
        "info": arr
    }));
    show(arr);
//去空
    titleDom.value = "";
    msgDom.value = "";

    addDom.style.display = "block";
    editOkDom.style.display = "none";
}
```

### 13.2  !!!案例--搜索-全选反选--搜索--增-删-改-隔行变色

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .form {
            display: flex;
        }
        .table {
            border-collapse: collapse;
            width: 70vw;
            text-align: center;
        }
        .table th,
        .table td {
            border: 1px solid brown;
        }

        .night {
            background: black;
            color: white;
        }
        #editOk {
            display: none;
        }
    </style>
</head>

<body>
    <h1>XXXX 博客管理系统</h1>
    <!-- 添加 -->
    <div>
        <form class="form">
            <div>
                <label for="title">新闻标题：</label>
                <input type="text" id="title">
            </div>
            <div>
                <label for="msg">新闻内容：</label>
                <input type="text" id="msg">
            </div>
            <div>
                <label for="user">作者姓名</label>
                <select name="" id="user">
                    <option value="张总编">编辑一部</option>
                    <option value="李总编">编辑二部</option>
                </select>
            </div>
            <div>
                <input type="button" value="添加新闻" id="add">
                <input type="button" value="确认修改" id="editOk">

            </div>
        </form>
    </div>
    <!-- 搜索 -->
    <div>
        <label for="">新闻检索：</label>
        <input type="text" id="search">
        <button id="searchBtn">搜索</button>
    </div>

    <button onclick="delAll()">全部删除</button>
    <button onclick="openClose()">开启夜间模式</button>

    <!-- 展示 -->
    <table class="table">
        <thead>
            <tr>
                <th>序号</th>
                <th>新闻标题</th>
                <th>新闻内容</th>
                <th>作者</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody id="tbody">
            <!-- <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <button>删除</button>
                </td>
            </tr> -->
        </tbody>
    </table>
    <script src="./01.js"></script>
</body>

</html>
```

```js
// 1、渲染

//1-1、模拟数据
// var arr= [
//     {"id":11,"check":false,"name":"百度","job":"前端工程师","money":28000},
//     {"id":2 2,"check":false,"name":"百度1","job":"前端工程师1","money":38000},
//     {"id":33,"check":false,"name":"百度2","job":"前端工程师2","money":48000},
//     {"id":44,"check":false,"name":"百度3","job":"前端工程师3","money":58000},
    
// ];

var arr=localStorage.getItem("p20616")?JSON.parse(  localStorage.getItem("p20616") ).info :[]

function show(res){
    var str="";
    for(var i=0;i<res.length;i++){
        if( i%2 ==0){
            str+=`
            <tr class="active">
                <td>
                    <input type="checkbox" ${res[i].check == true? "checked" :"" }  oninput="fan(${res[i].id})" > 
                </td>
                <td>${res[i].name}</td>
                <td>${res[i].job}</td>
                <td>${res[i].money}</td>
                <td>
                    <button onclick="del(${res[i].id})">删除</button>
                    <button onclick="edit(${res[i].id})">修改</button>
                </td>
            </tr>
            `
        }else{
            str+=`
            <tr >
                <td>
                    <input type="checkbox" ${res[i].check == true? "checked" :"" }  oninput="fan(${res[i].id})" > 
                </td>
                <td>${res[i].name}</td>
                <td>${res[i].job}</td>
                <td>${res[i].money}</td>
                <td>
                    <button onclick="del(${res[i].id})"> 删除</button>
                    <button onclick="edit(${res[i].id})">修改</button>
                </td>
            </tr>
            `  
        }   
    }
    document.getElementById("tbody").innerHTML=str;
}
window.onload=function(){
    show(arr);
}
// 删除

function del(id){
    var index= arr.findIndex(function(v){
        return v.id == id;
    })
    arr.splice(index,1);
    localStorage.setItem("p20616",JSON.stringify({ "info":arr }))
    show(arr);
}

function a(){
    var e= event ||window.event;

    // console.log(e.target.checked)
    var v= e.target.checked;
    for(var i=0;i<arr.length;i++){
        arr[i].check = v;
    }
    localStorage.setItem("p20616",JSON.stringify({ "info":arr }))
    show(arr);

}
//反选
function fan(id){
    var index= arr.findIndex(function(v){
        return v.id == id;
    })
    var e= event || window.event
    arr[index].check =e.target.checked;

    
    var i = arr.findIndex(function(value){
        return value.check === false
    })

    if( i == -1){
        document.getElementById("a").checked =true;
    }else{
        document.getElementById("a").checked =false;
    }
    localStorage.setItem("p20616",JSON.stringify({ "info":arr }))
    show(arr);

}
//全部删除
function clearAll(){
    arr=[];
    localStorage.setItem("p20616",JSON.stringify({ "info":arr }))
    show(arr);
}
//添加
var addDom=document.getElementById("add");
addDom.onclick=function(){
    var nameDom=document.getElementById("name");
    var jobDom=document.getElementById("job");
    var moneyDom=document.getElementById("money");

    var name= nameDom.value;
    var job= jobDom.value;
    var money= moneyDom.value;

    if(name && job && money){
        arr.push(
            {"id":new Date().getTime(),"check":false,"name":name,"job":job,"money":money}, 
        )
        localStorage.setItem("p20616",JSON.stringify({ "info":arr }))
        show(arr);
    }else{
        alert("不能为空");
    }
     //清空输入框
    nameDom.value="";
    jobDom.value="";
    moneyDom.value=""
  
}
//搜索
var searchFnDom=document.getElementById("searchFn");
searchFnDom.onclick=function(){
    var searchVal= document.getElementById("search").value;

    var nArr=arr.filter(function(value){
        return value.name.includes(searchVal)
    })
    localStorage.setItem("p20616",JSON.stringify({ "info":arr }))
    show(nArr);
}


var editIndex;
//修改
function edit(id){
    var index= arr.findIndex(function(v){
        return v.id == id;
    })

    editIndex =index;

    var enameDom=document.getElementById("ename");
    var ejobDom=document.getElementById("ejob");
    var emoneyDom=document.getElementById("emoney");

    enameDom.value = arr[index].name;
    ejobDom.value= arr[index].job;
    emoneyDom.value= arr[index].money;

}
//修改确认
var editOk=document.getElementById("editOk");

    editOk.onclick=function(){
        var enameDom=document.getElementById("ename");
        var ejobDom=document.getElementById("ejob");
        var emoneyDom=document.getElementById("emoney");

        var name= enameDom.value;
        var job= ejobDom.value;
        var money= emoneyDom.value;

        arr[editIndex].name=name;
        arr[editIndex].job=job;
        arr[editIndex].money=money;
//存储
        localStorage.setItem("p20616",JSON.stringify({ "info":arr }))
        show(arr);

    }
```

### 13-3  开启隔行变色--原理

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
  <span>全选</span>  <input type="checkbox" oninput="a()" id="a">

  <ul id="ul">
      <!-- <li>
          <input type="checkbox"> <span>111</span>
      </li> -->
     
  </ul>

  <script>
      var arr=[
          { "id":1,"title":"1111","check":true},
          { "id":2,"title":"2222","check":false},
          { "id":3,"title":"3333","check":true},
          { "id":4,"title":"4444","check":true}

      ];

      function show(res){
          var str="";
          for(var i=0;i<res.length;i++){
            str+=`
            <li>
                <input type="checkbox" ${res[i].check == true ?"checked":"" }  oninput="fan(${res[i].id})"> 
                <span>${res[i].title}</span>
            </li>
            `
          }
          document.getElementById("ul").innerHTML=str;
      }
      show(arr);

// 全选
      function a(){
        //   console.log("aaaaaaaa");
        var e= event || window.event;
        // console.log( e.target.checked );
        for(var i=0;i<arr.length;i++){
            arr[i].check =  e.target.checked 
        }

        show(arr);
      }
// 反选
      function fan(id){
        var index= arr.findIndex(function(v){
            return v.id == id;
        })
        var e= event || window.event;
        arr[index].check = e.target.checked;
        show(arr);
        // console.log(arr);
        var i = arr.findIndex(function(v){
            return v.check == false;
        })
        if(i==-1){
            document.getElementById("a").checked= true;
        }else{
            document.getElementById("a").checked= false;
        }
      }      
  </script>
</body>
</html>
```

### 13.4    全选反选--原理

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
  <span>全选</span>  <input type="checkbox" oninput="a()" id="a">
  <ul id="ul">
      <!-- <li>
          <input type="checkbox"> <span>111</span>
      </li> -->    
  </ul>
  <script>
      var arr=[
          { "id":1,"title":"1111","check":true},
          { "id":2,"title":"2222","check":false},
          { "id":3,"title":"3333","check":true},
          { "id":4,"title":"4444","check":true}
      ];

      function show(res){
          var str="";
          for(var i=0;i<res.length;i++){
            str+=`
            <li>
                <input type="checkbox" ${res[i].check == true ?"checked":"" }  oninput="fan(${res[i].id})"> 
                <span>${res[i].title}</span>
            </li>
            `
          }
          document.getElementById("ul").innerHTML=str;
      }
      show(arr);

// 全选
      function a(){
        //   console.log("aaaaaaaa");
        var e= event || window.event;
        // console.log( e.target.checked );
        for(var i=0;i<arr.length;i++){
            arr[i].check =  e.target.checked 
        }

        show(arr);
      }
// 反选
      function fan(id){
        var index= arr.findIndex(function(v){
            return v.id == id;
        })
        var e= event || window.event;
        arr[index].check = e.target.checked;
        show(arr);
        // console.log(arr);
        var i = arr.findIndex(function(v){
            return v.check == false;
        })
        if(i==-1){
            document.getElementById("a").checked= true;
        }else{
            document.getElementById("a").checked= false;
        }
      }
      
  </script>


</body>
</html>
```



# 2.14

### 14-1--拖动元素

```html
<div class="box">
<!-- 拖动元素 -->
<h1 draggable="true" ondragstart="drag()" id="one">哈哈哈</h1>
</div>

<!-- 目标元素 -->
<div class="box" ondragover="over()" ondrop="drop()" id="box2"></div>

    <script>
        function drag(){
            var e=event ||window.event;

            e.dataTransfer.setData("id",e.target.id)
        }

        function over(){
            var e=event ||window.event;
            e.preventDefault();
        }

        function drop(){
            var e=event ||window.event;
            e.preventDefault();
            var id=  e.dataTransfer.getData("id");

document.getElementById("box2").appendChild( document.getElementById(id) )
        }
```

### 14-2  svg矢量图

```js
    <svg width="100%" height="100%" version="1.1" xmlns="http://www.w3.org/2000/svg">

        <rect width="100" height="100" style="fill:rgb(0,0,255);stroke-width:1;
stroke:rgb(0,0,0)" />

    </svg>
```

### 14-3  canvas

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <canvas width="300" height="300" style="border:1px solid #d3d3d3;" id="one"></canvas>

    <script>
        var c = document.getElementById("one");
        var ctx = c.getContext("2d");
        ctx.beginPath(); //
        ctx.moveTo(0, 0); //开始位置
        ctx.lineTo(300, 300);
        ctx.strokeStyle = "red";
        ctx.stroke(); //画线条
        ctx.closePath();
        ctx.beginPath(); //
        ctx.rect(50, 50, 100, 200);
        ctx.stroke();
        ctx.closePath();
        ctx.beginPath(); //
        //      圆心x y ,半径，开始角度,结束角度 （Math.PI  === 180度）
        ctx.arc(100, 100, 30, 0, Math.PI);
        ctx.stroke();
        ctx.closePath();
    </script>
</body>

</html>
```

### 14.4  Apache ECharts可视化图标库

一个基于 JavaScript 的开源可视化图表库https://echarts.apache.org/zh/index.html

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <!-- 引入 ECharts 文件 -->
    <title>ECharts</title>
    <script src="./echarts.min.js"></script>
</head>

<body>
    <!-- 为 ECharts 准备一个具备大小（宽高）的 DOM -->
    <div id="main" style="width: 600px;height:400px;"></div>

    <script type="text/javascript">

        var arr=[
                    {"name":"衬衫","value":50},
                    {"name":"羊毛衫","value":20},
                    {"name":"雪纺衫","value":36},
                    {"name":"雪纺衫2","value":36},
                    {"name":"雪纺衫2","value":36},
                ]

        var x =[];
        var y=[];
        for(var i=0;i<arr.length;i++){
            x.push( arr[i].name );
            y.push( arr[i].value );
        }

        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));

        // 指定图表的配置项和数据
        var option = {
            title: {
                text: 'ECharts 入门示例'
            },
            tooltip: {},
            legend: {
                data:['销量']
            },
            xAxis: {
                data: x
            },
            yAxis: {},
            series: [{
                name: '销量',
                type: 'bar',
                data:y,
                itemStyle: {
            normal: {
　　　　　　　　//这里是重点
                color: function(params) {
                	//注意，如果颜色太少的话，后面颜色不会自动循环，最好多定义几个颜色
                    var colorList = ['#c23531','#2f4554', '#61a0a8', '#d48265', '#91c7ae','#749f83', '#ca8622'];
                    return colorList[params.dataIndex]
                }
            }
        }
            }],                      
        };
        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    </script>
</body>
</html>
```

### 14.5  动画

### 14.6   案例左右穿梭框之两数组方法

```html
<!DOCTYPE html>
<html>
 <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>穿梭框</title>
    <style>
        #box {
            width: 600px;
            margin: auto;
        }
        #box2 {
            display: flex;
            padding: 10px;
        }
        #box2>div {
            height: 300px;
            width: 200px;
        }
        #box3, #box5 {
            border: 1px solid red;
        }
        #box4 {
            text-align: center;
        }
        ol>li {
            cursor: pointer;
            width: 80%;
        }
        ol>li:hover {
            background-color: #f90;
        }
        .active {
            background-color: #ddd;
        }
    </style>
</head>

<body>
    <div id="box">
        <div id="entry">
            <label>
                模块名称:<input type="text" id="moduleName" />
            </label>
            <button type="button" id="addModule">添加</button>
        </div>
        <div id="box2">
            <div id="box3">
                <h2>未选模块</h2>
                <ol id="box6"></ol>
            </div>
            <div id="box4">
                <button type="button" id="addAll">全部添加&gt;&gt;</button><br /><br />
                <button type="button" id="add">添加&gt;&gt;</button><br /><br />
                <button type="button" id="del">&lt;&lt;删除</button><br /><br />
                <button type="button" id="delAll">&lt;&lt;全部删除</button>
            </div>
            <div id="box5">
                <h2>已选模块</h2>
                <ol id="box7"></ol>
            </div>
        </div>
    </div>
    <script>
        //获取到频道名称模块 
        var moduleName = document.getElementById("moduleName");
        // 获取到添加按钮
        var addModule = document.getElementById("addModule");
        // 获取到左方盒子
        var box6 = document.getElementById("box6");
        // 获取到右方盒子
        var box7 = document.getElementById("box7");
        // 获取到全部添加按钮
        var addAll = document.getElementById("addAll");
        // 获取到添加到右边按钮
        var add = document.getElementById("add");
        // 获取到删除到左边按钮
        var del = document.getElementById("del");
        // 获取到删除全部按钮
        var delAll = document.getElementById("delAll");
 
        var tempArr1 = [];
        var tempArr2 = [];

        if (localStorage.obj1220) {
            var obj = JSON.parse(localStorage.obj1220);
            var left = obj.left;
            var right = obj.right;
            showDom(left, box6);
            showDom(right, box7);
        } else {
            var obj = {
                left: [],
                right: []
            }
            localStorage.obj1220 = JSON.stringify(obj);
        }
        //console.log("localStorage:",localStorage.obj1220);
 
        addModule.onclick = function () {
            
            var mName = moduleName.value;
            if (mName) {
                var obj = JSON.parse(localStorage.obj1220);
                obj.left.push(mName);
                console.log("obj:", obj);
                localStorage.obj1220 = JSON.stringify(obj);
                var left = obj.left;
                var right = obj.right;
                showDom(left, box6);
                showDom(right, box7);
                moduleName.value = "";
            } else {
                alert("模块名称不能为空");
            }
        }

        addAll.onclick = function () {
            all(1);
        }
 
        delAll.onclick = function () {
            all(vv0);
        }
 
        box6.onclick = function (event) {
            var e = event || window.event;
            upd(1, e);
        }

        add.onclick = function () {
            if (tempArr1.length > 0) {
                var obj = JSON.parse(localStorage.obj1220);
                var left = obj.left;
                var right = obj.right;
                var left = left.filter(function (a, b) {
                    //console.log("a:",a,"b:",b);
                    return tempArr1.indexOf(a) == -1;
                });
                console.log("left:", left);
                right = right.concat(tempArr1);
                console.log("right:", right);
                obj.left = left;
                obj.right = right;
                localStorage.obj1220 = JSON.stringify(obj);
                showDom(left, box6);
                showDom(right, box7);
                tempArr1 = [];
            } else {
                alert("请选择要添加的项");
            }
        }

        box7.onclick = function (event) {
            var e = event || window.event;
            upd(0, e);
        }

        del.onclick = function () {
            if (tempArr2.length > 0) {
                var obj = JSON.parse(localStorage.obj1220);
                var left = obj.left;
                var right = obj.right;
 
                var right = right.filter(function (a, b) {
                    //console.log("a:",a,"b:",b);
                    return tempArr2.indexOf(a) == -1;
                });
                console.log("left:", left);
                left = left.concat(tempArr2);
                console.log("right:", right);
                obj.left = left;
                obj.right = right;
                localStorage.obj1220 = JSON.stringify(obj);
                showDom(left, box6);
                showDom(right, box7);
                tempArr2 = [];
            } else {
                alert("请选择要添加的项");
            }
        }
 
        function upd(f, e) {
            //console.log("e:",e);
            var d = e.path[2];
            var lis = d.querySelectorAll("li");
            lis = Array.prototype.slice.call(lis);
            var i = 0;
 
            var obj = JSON.parse(localStorage.obj1220);
            var left = obj.left;
            var right = obj.right;
            if (e.target.nodeName == "LI") {
                i = lis.indexOf(e.target);
                if (e.target.classList.contains("active")) {
                    e.target.classList.remove("active");
                    if (f) {
                        var a = tempArr1.indexOf(left[i]);
                        tempArr1.splice(a, 1);
                    } else {
                        var b = tempArr1.indexOf(right[i]);
                        tempArr2.splice(b, 1);
                    }

                } else {
                    e.target.classList.add("active");
                    if (f) {
                        tempArr1.push(left[i]);
                    } else {
                        tempArr2.push(right[i]);
                    }
                }
            }
            console.log("tempArr1:", tempArr1);
            console.log("tempArr2:", tempArr2);
        }
        function all(f) {
            var obj = JSON.parse(localStorage.obj1220);
            var left = obj.left;
            var right = obj.right;
            if (f) {
                right = right.concat(left);
                left = [];
            } else {
                left = left.concat(right);
                right = [];
            }
            obj.left = left;
            obj.right = right;
            localStorage.obj1220 = JSON.stringify(obj);
            showDom(left, box6);
            showDom(right, box7);
        }
        function showDom(arr, dom) {
            dom.innerHTML = "";
            var li = "";
            for (var i = 0; i < arr.length; i++) {
                if (arr[i]) {
                    li += "<li>" + arr[i] + "</li>";
                }
            }
            dom.innerHTML = li;
        }
    </script>
</body>
</html>
```

### 14.7  分页原理

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .page {
            display: flex;
        }
    </style>
</head>

<body>
    <ul id="ul">

    </ul>
    <p>
        总 <span id="total">x</span>页 每页显示 5条 当前第 <span id="nowpage">x</span>页
    </p>

    <div class="page">
        <button onclick="prevPage()">上一页</button>

        <div id="pageBtn">
            <!-- <button>1</button>
             <button>2</button>
             <button>3</button> -->
        </div>

        <button onclick="nextPage()">下一页</button>

        <input type="text"> <button>跳转</button>
    </div>

    <script>
        var totalDom = document.getElementById("total");
        var nowpageDom = document.getElementById("nowpage");

        var page = 1; // 当前第一页
        var limit = 5; // 每页显示条数
        var total = 0;
        // 每页 显示5条  16 条数据 。 总共 4 页 
        var arr = [{
                "id": 1,
                "title": "aaa"
            },
            {
                "id": 2,
                "title": "bbb"
            },
            {
                "id": 3,
                "title": "ccc"
            },
            {
                "id": 4,
                "title": "ddd"
            },
            {
                "id": 5,
                "title": "eee"
            },
            {
                "id": 6,
                "title": "fff"
            },
            {
                "id": 7,
                "title": "ggg"
            },
            {
                "id": 8,
                "title": "hhh"
            },
            {
                "id": 9,
                "title": "iii"
            },
            {
                "id": 10,
                "title": "jjj"
            },
            {
                "id": 11,
                "title": "kkk"
            },
            {
                "id": 12,
                "title": "lll"
            },
            {
                "id": 13,
                "title": "mmm"
            },
            {
                "id": 14,
                "title": "nnn"
            },
            {
                "id": 15,
                "title": "ooo"
            },
            {
                "id": 16,
                "title": "ppp"
            },
        ];
        //console.log( arr.slice( (page-1)*limit ,page*limit) );// 分页原理

        // 计算 总 页数 = 总条数/每页显示条数 向上取整
        function totalFn(shuJu, tiaoShu) {
            return Math.ceil(shuJu.length / tiaoShu)
        }
        // 循环 分页 按钮
        function pageBtn(n) {
            // n 总页数 4
            var str = "";
            for (var i = 0; i < n; i++) {
                str += `
                <button onclick="fy(${i+1})">${i+1}</button>
                `
            }
            document.getElementById("pageBtn").innerHTML = str;

        }
        // 渲染
        function show(res) {
            var str = "";
            for (var i = 0; i < res.length; i++) {
                str += `
                     <li>${res[i].title}</li>
                `
            }
            document.getElementById("ul").innerHTML = str;
        }
        window.onload = function () {
            total = totalFn(arr, limit);
            pageBtn(total);
            totalDom.innerText = total;
            nowpageDom.innerText = page;

            show(arr.slice((page - 1) * limit, page * limit))
        }
        // 点击  按钮 1 2 3 4 
        function fy(n) {
            page = n;
            show(arr.slice((page - 1) * limit, page * limit));
            nowpageDom.innerText = page;

            var e = event || window.event;
            var btns = e.target.parentNode.children;
            for (var i = 0; i < btns.length; i++) {
                btns[i].style.color = "black";
            }
            e.target.style.color = "red";

        }
        // 下一 页
        function nextPage() {
            if (page < total) {
                page++;

                show(arr.slice((page - 1) * limit, page * limit));
            } else {
                alert("已经是最后一页了")
            }
        }
        //   上一页

        function prevPage() {
            if (page > 1) {
                page--;

                show(arr.slice((page - 1) * limit, page * limit));
            } else {
                alert("已经是首页了")
            }
        }
    </script>

</body>

</html>
```

# 2.15



# 2.16

### 数组扁平化

```js
// var arr=[ 1,"aa",true,{"name":"gao"}, [1,2]  ];
        var arr=[ 1,2,3,[4,5,[6,7]] ]; // 多维数组
        //递归 降维  / 扁平化
        var x=[]
        function xx(arr){    
            for(var i=0;i<arr.length;i++){
                if( Array.isArray( arr[i] ) ){
                    xx(arr[i])
                }else{
                    x.push(arr[i])
                }
            }
            return x;            
        }
         console.log(  xx(arr) );
```

### 回调函数

```js
//函数声明 
/*
    function fn1(){
        console.log("111")
    }
    fn1();

    var fn2=function(){
        console.log("222")

    }
    fn2()
    var fn3=new Function("x","y","return x+y");
    console.log( fn3(1,2) )
*/
    // 把一个函数 当作参数 传入另一个函数  --- 回调函数
    function a( x ){
        x(); 
    }
    a( function(){ console.log("哈哈哈哈") }   )
//---------------------------

    function b(x){
        x( 1,2 )
    }
    b( function(j,p){
        console.log( j+p );
       }     
    )
```

### 闭包

```js
// 函数 当作 另一个函数的返回值 -- 闭包函数
// 可以访问 函数 内部变量的 函数叫闭包函数---闭包
// 通常写法： 函数嵌套函数  
// 优点、作用： 可以访问 另一个函数的内部变量 
//            变量 长期驻扎内存 ，不会销毁
// 缺点     ：内存泄漏
function ff(){
    var xx =123; 
    return function(){
        console.log("哈",xx); // 闭包变量
    }
}  
ff()();
  // 函数当作 参数值  -- 回调 函数
  // 函数当作 返回值  -- 闭包 函数
```

### 16-1  留言板案例

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/1.css">
</head>

<body>
    <!-- 发表留言 -->
    <div class="box1">
        <div class="header" id="header">
            <p>头像</p>
            <img src="./images/a.PNG" alt="">
            <img src="./images/b.PNG" alt="">
            <img src="./images/c.PNG" alt="">
            <img src="./images/d.PNG" alt="">
        </div>

        <textarea name="" id="msg" cols="30" rows="10" maxlength="18"></textarea>
        <div class="addbox">
            <button id="add">发表 </button>
            <p>还可以输入<span id="num">18</span>个字，最多18个</p>
        </div>
    </div>

    <!-- 留言展示 -->
    <div class="box2" id="box2">
        <!-- <div>
            <div class="item"> 
                <img src="./img/a.PNG" alt="">
                <p>是，，，，短发家里的飞机啊算了</p>
                <button>删除</button>
            </div>
            <p>2020-11-11 下午3:34:11</p>
            <hr/>
        </div> -->
    </div>

    <script src="./1.js"></script>
</body>

</html>
```

```css
*{
    margin: 0;
    padding: 0;
}
.box1{
    width: 360px;
    border: 1px solid red;

}
.header{
    display: flex;
    align-items: center;
}
.header > img{
    width: 80px;
    height: 80px;
}
#msg{
    width: 350px;
}
.addbox{
    display: flex; 
    justify-content: space-between; 
}
.box2{
    margin-top: 10px;
    width: 360px;
    border: 1px solid red;
}
.item{
    display: flex;
    justify-content: space-between;
}
.item >img {
    width: 50px;
    height: 50px;

}
.b{
    border: 5px solid red;
}
```

```js
//模拟数据
// var arr=[
//     // { "id":11, "img":"./img/a.PNG","msg":"啊啊啊啊","time":11111111},
//     // { "id":22, "img":"./img/b.PNG","msg":"啊啊啊啊1","time":11111111},
//     // { "id":33, "img":"./img/c.PNG","msg":"啊啊啊啊2","time":11111111},
//     // { "id":44, "img":"./img/d.PNG","msg":"啊啊啊啊3","time":11111111},

// ]

var arr = localStorage.getItem("p2062103") ? JSON.parse(localStorage.getItem("p2062103")).info : []

function show(res) {
    var str = "";
    for (var i = 0; i < res.length; i++) {
        str += `
        <div>
            <div class="item"> 
                <img src="${res[i].img}" alt="">
                <p>${res[i].msg}</p>
                <button onclick="del(${res[i].id})">删除</button>
            </div>
            <p>${myTime(res[i].time)}</p>
            <hr/>
        </div>
        `
    }
    document.getElementById("box2").innerHTML = str;
}

window.onload = function () {
    show(arr);
}

//删除
function del(id) {

    //获得id普通函数写法
    // var index= arr.findIndex(function(v){
    //     return  v.id == id 
    // } )

    //获得id箭头函数写法
    var index = arr.findIndex(v => v.id == id)
    //找到下标,删除数据
    arr.splice(index, 1);
    //删除后保存
    localStorage.setItem("p2062103", JSON.stringify({
        "info": arr
    }));
    //最新的数据渲染到页面
    show(arr);
}

//获取图片
var img = document.querySelectorAll("#header >img");
//给四个图片节点添加点击事件,添加高亮样式(点中的加,其他的去样式)
for (let i = 0; i < img.length; i++) {
    img[i].onclick = function () {
        for (var j = 0; j < img.length; j++) {
            img[j].classList.remove("b");
        }

        img[i].classList.add("b");

    }
}
//获取输入框的文字
var msgDom = document.getElementById("msg");
//当文字输入时,触发事件,显示还有多少文字可输入
msgDom.oninput = function () {
    var x = 18 - msgDom.value.length;

    document.getElementById("num").innerText = x;
}

//添加
var addDom = document.getElementById("add");
addDom.onclick = function () {
    //循环图片节点,判断是否有高亮class,有则终止
    var index = -1;
    for (var i = 0; i < img.length; i++) {
        if (img[i].classList.contains("b")) {
            index = i;
            break;
        }
    }
    //获取输入的留言板文字内容
    var msg = msgDom.value;
    //非空验证
    if (index > -1 && msg.length > 0) {
        //非空则加入到添加
        arr.push({
            "id": new Date().getTime(),
            "img": img[index].src,
            "msg": msg,
            "time": new Date().getTime()
        })
        //保存
        localStorage.setItem("p2062103", JSON.stringify({
            "info": arr
        }));
        //渲染页面
        show(arr);

    } else {
        alert("不能输入");
    }


    //  清空 内容 
    msgDom.value = "";
    document.getElementById("num").innerText = 18;
    for (var j = 0; j < img.length; j++) {
        img[j].classList.remove("b");
    }


}
//封装时间格式
function myTime(t) {
    var time = new Date(t);
    var year = time.getFullYear();
    var month = (time.getMonth() + 1).toString().padStart(2, "0");
    var date = time.getDate().toString().padStart(2, "0");

    var hours = time.getHours().toString().padStart(2, "0");
    var minutes = time.getMinutes().toString().padStart(2, "0");
    var seconds = time.getSeconds().toString().padStart(2, "0");

    return `${year}年 ${month}月${date}日 ${hours}:${minutes}:${seconds}`;
}
```



# 2.17

### 17.1  购物车案例--增-删-全选反选-数量加减

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/index.css">
    <title>Document</title>
</head>

<body>
    <div class="con W1410">
        <div class="con_top">
            <table>
                <thead class="con_top_head">
                    <tr>
                        <th>
                            <input type="checkbox" id="allCheck" > 全选
                        </th>
                        <th></th>
                        <th>商品名称</th>
                        <th>单价</th>
                        <th>数量</th>
                        <th>小计</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody class="con_top_body" >
                    <!-- <tr>
                        <td><input type="checkbox"  name="check" ></td>
                        <td class="img">
                            <img src="images/Bi.png" alt="">
                        </td>
                        <td class="name">
                            巨能写
                        </td>
                        <td class="price">39.9元</td>
                        <td class="math">
                            <div class="b1">-</div>
                            <div class="b2">10</div>
                            <div class="b3" >+</div>
                        </td>
                        <td class="maxPrice"><span>39.9</span>元</td>
                        <td class="del">X</td>
                    </tr> -->
                </tbody>
            </table>
            <div class="all">
                <div class="all_1">继续购物</div>
                <div class="all_2">共 <span id="all">0</span> 件商品，已选择 <span id="has">0</span> 件</div>
                <div class="all_3">合计：<span id="allPrice">39</span>元</div>
                <div class="all_4">去结算</div>
            </div>
        </div>
        <div class="con_bottom">
            <!-- <div class="bottom_box">
                <img src="images/Bi.png" alt="">
                <h4>巨能写</h4>
                <span>39.9元</span>
                <p>1000人好评</p>
                <div class="add">加入购物车</div>
            </div> -->            
        </div>
    </div>
    <script src="js/index.js"></script>
</body>

</html>
```

```js
// 推荐商品 数据
var arr=[
	{
        "id":11,
		"goodsName":"Redmi&emsp;AirDots真无线蓝牙",
		"img":"ErJi.png",
		"price":99.9,
		"goodsRatings":"4.3万人好评",
		"check":false
	}, {
        "id":22,
		"goodsName":"小米小书包",
		"img":"ShuBao.png",
		"price":29,
		"goodsRatings":"4万人好评",
		"check":false
	}, {
        "id":33,
		"goodsName":"小米巨能写中性笔",
		"img":"Bi.png",
		"price":9.99,
		"goodsRatings":"2068人好评",
		"check":false
	},{
        "id":44,
		"goodsName":"贝医生0+防蛀健齿牙膏",
		"img":"YaGao.png",
		"price":12.9,
		"goodsRatings":"5263万人好评",
		"check":false
	},{
        "id":55,
		"goodsName":"小米手环3/4通用腕带",
		"img":"ShouHuan.png",
		"price":19.9,
		"goodsRatings":"5384万人好评",
		"check":false
	}
]

// 购物车数据

// var carArr=[
//     {
//         "id":11,
// 		"goodsName":"Redmi AirDots真无线蓝牙",
// 		"img":"ErJi.png",
// 		"price":99.9,
// 		"check":false,
//         "num":1
// 	},
//     {
//         "id":22,
// 		"goodsName":"小米小书包",
// 		"img":"ShuBao.png",
// 		"price":29,
// 		"check":true,
//         "num":2
// 	}
// ]

var carArr=localStorage.getItem("p20622am")?JSON.parse( localStorage.getItem("p20622am") ).info :[];

// 渲染 推荐商品

function showGoods(arr){
    var str="";
    
    arr.forEach(function(v,index){
        str+=`
        <div class="bottom_box">
                <img src="images/${v.img}" alt="">
                <h4>${v.goodsName}</h4>
                <span>${v.price}元</span>
                <p>${v.goodsRatings}</p>
                <div class="add" onclick=add('${JSON.stringify(v)}')>加入购物车</div>
         </div>
        `
    })
    // for(var v of arr){
       
    // }
   document.querySelector(".con_bottom").innerHTML=str;

  
}
// 渲染 购物车
function showCar(arr){
    var str="";
    arr.forEach((v,index)=>{
        str+=`
        <tr>
            <td><input type="checkbox" ${v.check? "checked" :""}  name="check" oninput="oneCheck(${v.id})" ></td>
            <td class="img">
                <img src="images/${v.img}" alt="">
            </td>
            <td class="name">
                ${v.goodsName}
            </td>
            <td class="price">${v.price}元</td>
            <td class="math">
                <div class="b1" onclick="decrease(${v.id})">-</div>
                <div class="b2">${v.num}</div>
                <div class="b3" onclick="increase(${v.id})">+</div>
            </td>
            <td class="maxPrice"><span>${ (v.price*v.num).toFixed(2) }</span>元</td>
            <td class="del" onclick="del(${v.id})">X</td>
        </tr>
        `
    })

    document.querySelector(".con_top_body").innerHTML=str;
}

window.onload=function(){
    showGoods(arr);
    showCar(carArr);
    count(carArr);
}
//删除购物车数据
function del(id){
    // var index = carArr.findIndex(function(v){ return v.id == id });
    var index = carArr.findIndex(v=>v.id == id);
    carArr.splice(index,1);

   
    showCar(carArr);
    count(carArr);
    localStorage.setItem("p20622am",JSON.stringify({"info":carArr}));

}

// 数量减
function decrease(id){
    var index = carArr.findIndex(v=>v.id == id);
        if(carArr[index].num >1){
            carArr[index].num -=1;
            showCar(carArr);
        }else{
            carArr.splice(index,1);
            showCar(carArr);
        }
        count(carArr);
        localStorage.setItem("p20622am",JSON.stringify({"info":carArr}));  
}

// 数量加 
function increase(id){
    var index = carArr.findIndex(v=>v.id == id);
        carArr[index].num +=1;
        showCar(carArr);  
        count(carArr);
        localStorage.setItem("p20622am",JSON.stringify({"info":carArr}));
}

// 全选
var allCheckDom=document.getElementById("allCheck");
    allCheckDom.oninput=function(){
      
        var allCheck= allCheckDom.checked ;
        carArr.forEach(function(v,index){
            v.check= allCheck;
        })

        showCar(carArr);
        count(carArr);
        localStorage.setItem("p20622am",JSON.stringify({"info":carArr}));
    }

// 选中每一项
function oneCheck(id){
    var index = carArr.findIndex(v=>v.id == id);
        carArr[index].check=!carArr[index].check;

    var flag = carArr.findIndex(v=>v.check == false);
    if(flag==-1){
        allCheckDom.checked=true;
    }else{
        allCheckDom.checked=false;
    }
        showCar(carArr);
        count(carArr);
        localStorage.setItem("p20622am",JSON.stringify({"info":carArr}));
}

// 计算 共 X 件商品、已选择X 件、合计多少元

function count(arr){
    var total=0;// 共 X 件商品
    var buy  =0;//已选择X 件
    var money =0;//合计多少元

    arr.forEach(function(v,index){
        total += v.num;
        if(v.check == true){
            buy+= v.num;
            money +=  v.num * v.price;
        }
    })

    document.getElementById("all").innerText=total;
    document.getElementById("has").innerText=buy;
    document.getElementById("allPrice").innerText= money.toFixed(2);

}

// 加入购物车

function add(v){
    var obj= JSON.parse(v);

   var index= carArr.findIndex(function(v){
        return v.id == obj.id;
   })

   if(index == -1){

      carArr.push( {
        "id":obj.id,
		"goodsName":obj.goodsName,
		"img":obj.img,
		"price":obj.price,
		"check":obj.check,
        "num":1
	});

   }else{
       carArr[index].num +=1;
   }

   showCar(carArr);
   count(carArr);
   localStorage.setItem("p20622am",JSON.stringify({"info":carArr}));

}

```

### 17.2  表格样式商品管理--分类-分页-增删-改

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/index.css">
</head>
<body>
    
    <div class="box">
        <!-- 添加修改 -->
        <form  class="addEditForm">
            <div>
                <label for="">图片地址</label>
                <input type="text" id="img">
            </div>

            <div>
                <label for="">简介</label>
                <input type="text" id="name">
            </div>
            <div>
                <label for="">价格</label>
                <input type="text" id="price">
            </div>
            <div>
                <label for="">类别</label>
                <select name="" id="type">
                    <option value="冰箱">冰箱</option>
                    <option value="电脑">电脑</option>
                    <option value="手机">手机 </option>
                </select>
            </div>
            <div>
               
                <input type="button" value="添加" id="add">
                <input type="button" value="确认修改" id="editOk">

            </div>
        </form>

        <div id="search">
            <button>全部</button>
            <button>冰箱</button>
            <button>电脑</button>
            <button>手机</button>
        </div>

        <!-- 表格展示 -->
        <table class="showTable">
            <thead>
                <tr>
                    <th>图片</th>
                    <th>简介</th>
                    <th>价格</th>
                    <th>类别</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody id="tbody">
                <!-- <tr>
                    <td>
                        <img src="./img/bx1.jpg" alt="">
                    </td>
                    <td>aaaaaaaaaa</td>
                    <td>¥6777</td>
                    <td>电脑 </td>
                    <td>
                        <span>修改</span> &emsp; &emsp;
                        <span>删除</span>
                    </td>
                </tr> -->
            </tbody>
        </table>

        <div class="page"> 
            <span id="total">11</span>页
            <span>上一页</span>
            <ul id="pageList">
                <li>1</li>
                <li>1</li>
                <li>1</li>
                <li>1</li>
            </ul>
            <span>下一页</span>
        </div>

    </div>
    <script src="./js/index.js"></script>
</body>
</html>
```

```js
/*
var arr=[
    {
        "id":11,
        "img":"bx1",
        "name":"啊啊啊啊啊啊",
        "price":667,
        "type":"冰箱",
    },
    {
        "id":22,
        "img":"dn1",
        "name":"啊啊啊啊啊啊222",
        "price":444,
        "type":"电脑",
    },
    {
        "id":33,
        "img":"sj1",
        "name":"啊啊啊啊啊啊11",
        "price":666,
        "type":"手机",
    }

]
*/

var arr =localStorage.getItem("p20622pm")?JSON.parse(localStorage.getItem("p20622pm")).info :[];
var limit = 3;      //每页显示条数
var page =1;        //当前页数
var total =0;       //总页数
var type = "全部"; //筛选类型
var newArr=[];     //筛选后数组


function $(el){
   return document.getElementById(el);
}
function $all(el){
    return document.querySelectorAll(el)
}

//总页数
function totalFn(arr){
    total= Math.ceil(  arr.length / limit);
    $("total").innerText=total;

    var str=""
    for(var i=0;i<total;i++){
        str+=`
        <li  onclick="pageFn(${i+1})">${i+1}</li>
        `
    }
    $("pageList").innerHTML=str;

}

// 第 几页

function pageFn(p){
    page= p;
    if(type == "全部"){
        show( arr.slice( (page-1)*limit ,page*limit)  ); 
    }else{
        show( newArr.slice( (page-1)*limit ,page*limit)  )
    }
    pageClass(p);
   
}
// 选中 分页 按钮 加背景颜色
function pageClass(p){
    
    Array.from( $all("#pageList > li") ).forEach(v=>{
        v.style.background="gray"
    })

    $all("#pageList > li")[ p-1 ].style.background="red";
}



// 渲染
function show(arr){
    var str="";
    arr.forEach(function(v,index){
        str+=`
        <tr>
            <td>
                <img src="./img/${v.img}.jpg" alt="">
            </td>
            <td>${v.name}</td>
            <td>¥${v.price}</td>
            <td>${v.type}</td>
            <td>
                <span onclick=edit(${JSON.stringify(v)}) >修改</span> &emsp; &emsp;
                <span onclick="del(${v.id})">删除</span>
            </td>
        </tr>
        `
    })
    document.getElementById("tbody").innerHTML=str;
  
}

window.onload=function(){
    show( arr.slice( (page-1)*limit ,page*limit)  ); // 
    totalFn(arr);
    pageClass(page);
}
// 删除

function del(id){
    var index= arr.findIndex(v=>v.id == id);
    arr.splice(index,1);
    localStorage.setItem("p20622pm", JSON.stringify( {"info":arr}) );// 存
    show( arr.slice( (page-1)*limit ,page*limit)  );
    totalFn(arr);
}

// 筛选
var btnDom=document.querySelectorAll("#search >button");
for(let i=0;i<btnDom.length;i++){
  
    btnDom[i].onclick=function(){
     
        for(let j= 0;j<btnDom.length;j++){
            btnDom[j].classList.remove("active");
        }

        btnDom[i].classList.add("active");

         type= btnDom[i].innerText;
        // console.log(type);

        if( type == "全部"){
            page=1;
           

            show( arr.slice( (page-1)*limit ,page*limit)  );
            totalFn(arr);
            pageClass(page);
        }else{
          
            newArr= arr.filter(function(v){
                return v.type == type
            })
            page=1;
           
            show( newArr.slice( (page-1)*limit ,page*limit)  );
            totalFn(newArr);
            pageClass(page);
        }


    }
}

// 添加

$("add").onclick=function(){
    var img= $("img").value;
    var name= $("name").value;
    var price= $("price").value;
    var type= $("type").value;

    if(img && name && price  && type){
        arr.unshift({
            "id":new Date().getTime(),
            "img":img,
            "name":name,
            "price":price,
            "type":type,
        })
        show( arr.slice( (page-1)*limit ,page*limit)  );
        totalFn(arr);
        pageClass(page);
        localStorage.setItem("p20622pm", JSON.stringify( {"info":arr}) );// 存

    }else{
        alert("不能为空");
    }

}

//修改
var editIndex;
function edit(obj){
    $("editOk").style.display="block";

    $("add").style.display="none";
    // console.log(obj);
    editIndex = arr.findIndex(v=>v.id == obj.id);
    $("img").value =obj.img;
    $("name").value=obj.name;
    $("price").value=obj.price;
    $("type").value=obj.type;

}
// 确认修改
$("editOk").onclick=function(){
    
    var img= $("img").value;
    var name= $("name").value;
    var price= $("price").value;
    var type= $("type").value;
    arr[editIndex].img= img;
    arr[editIndex].name= name;
    arr[editIndex].price= price;
    arr[editIndex].type= type;
    show( arr.slice( (page-1)*limit ,page*limit)  );

    $("img").value ="";
    $("name").value="";
    $("price").value="";

    this.style.display="none";

    $("add").style.display="block";
    localStorage.setItem("p20622pm", JSON.stringify( {"info":arr}) );// 存

}

```



# 2.18

### 18.1穿梭框之4数组方法

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .box{
            display: flex;
        }
        .box >div{
            width: 200px;
            min-height: 200px;
            border: 1px solid red;
        }
    </style>
</head>
<body>
    <div class="box">
        <!-- 左边 -->
        <div>
            <ul id="left">
                <!-- <li>111</li> -->
            </ul>
        </div>
        <!-- 中间 -->
        <div>
            <p id="allRight">全部向右</p>
            <p id="toRight"> 向右 </p>
            <p id="toLeft">  向左 </p>
            <p id="allLeft">全部向左</p>

        </div>

        <!-- 右边 -->
        <div>
            <ul id="right">
                <!-- <li>111</li> -->
            </ul>
        </div>

    </div>
    <script src="./01.js"></script>
</body>
</html>
```

```js
var left=[
    {"id":11,"name":"aaa","age":19},
    {"id":22,"name":"bbb","age":18},
    {"id":33,"name":"ccc","age":17},
    {"id":44,"name":"eee","age":16},

];

var right=[
    {"id":55,"name":"嗷嗷","age":199},
    {"id":66,"name":"哈哈","age":188},
    {"id":77,"name":"呵呵","age":177},
    {"id":88,"name":"哦哦","age":166},
];

var leftSelect=[];
var rightSelect=[];

// 渲染左边
function showLeft(arr){
    var str="";
    arr.forEach(function(v){
        str+=`
            <li onclick="leftSelectFn(${v.id})">${v.name} -- ${v.age} </li>
        `
    })

    document.getElementById("left").innerHTML=str;
}
// 选中左边
function leftSelectFn(id){
    var e= event || window.event;
   var index= leftSelect.findIndex(function(v){
        return v  == id
    })
    if(index == -1){
        leftSelect.push(id);
        e.target.style.background="red";
    }else{
        leftSelect.splice(index,1);
        e.target.style.background="";
    }

    console.log(leftSelect);
 
}

//渲染右边
function showRight(arr){
    var str="";
    arr.forEach(function(v){
        str+=`
        <li onclick="rightSelectFn(${v.id})">${v.name} -- ${v.age} </li>
        `
    })

    document.getElementById("right").innerHTML=str;
}

//选中右边
function rightSelectFn(id){
    var e= event || window.event;
   var index= rightSelect.findIndex(function(v){
        return v  == id
    })
    if(index == -1){
        rightSelect.push(id);
        e.target.style.background="red";
    }else{
        rightSelect.splice(index,1);
        e.target.style.background="";
    }

    console.log(rightSelect);
 
}

window.onload=function(){
    showLeft(left)
    showRight(right)
}

var toRightDom=document.getElementById("toRight");
    toRightDom.onclick=function(){
        // 根据左边 选中 的 数组 leftSelect=【11，22，33】
        //                                 id id id
        // 循环 这个  leftSelect 通过 id 找到 index ， right.push(  left[index] )

        leftSelect.forEach(function(v){
            var index = left.findIndex(function(value){
                return value.id == v
            })

            right.push( left[index] );

            left.splice(index,1);
        })

        showLeft(left)
        showRight(right)
        leftSelect=[];
        rightSelect=[];
    }

var toLeftDom=document.getElementById("toLeft");
toLeftDom.onclick=function(){
        // 根据左边 选中 的 数组 leftSelect=【11，22，33】
        //                                 id id id
        // 循环 这个  leftSelect 通过 id 找到 index ， right.push(  left[index] )

        rightSelect.forEach(function(v){
            var index = right.findIndex(function(value){
                return value.id == v
            })

            left.push( right[index] );

            right.splice(index,1);
        })

        showLeft(left)
        showRight(right)
        leftSelect=[];
        rightSelect=[];
    }

var allRightDom=document.getElementById("allRight");
    allRightDom.onclick=function(){
        var n= right.concat(left);
        right= n;
        left =[];
        showLeft(left)
        showRight(right)
    }

var allLeftDom=document.getElementById("allLeft");
    allLeftDom.onclick=function(){
        var n= left.concat(right);
        left= n;
        right =[];

        showLeft(left)
        showRight(right)

    }
```

